"use strict";const e=["onValueChange","value"];var t,n,a,i,s,o,l,r,d,c,u,p,h,m,g,f,x,y,v,b,j,I,C,w,T,k,S,_,E,M,R,B,D,z,F,A,q,O,L,P,U,N;function V(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},s=Object.keys(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function X(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(n),!0).forEach((function(t){H(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function H(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Y(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}Object.defineProperty(exports,"__esModule",{value:!0});var G=require("sanity"),W=require("@sanity/icons"),$=require("react/jsx-runtime"),K=require("@sanity/ui"),Z=require("react"),J=require("is-hotkey"),ee=require("groq"),te=require("react-redux"),ne=require("@reduxjs/toolkit"),ae=require("nanoid"),ie=require("redux-observable"),se=require("rxjs"),oe=require("rxjs/operators"),le=require("@sanity/color"),re=require("styled-components"),de=require("pluralize"),ce=require("@tanem/react-nprogress"),ue=require("react-select"),pe=require("react-virtuoso"),he=require("@hookform/resolvers/yup"),me=require("react-hook-form"),ge=require("yup"),fe=require("date-fns/format"),xe=require("filesize"),ye=require("copy-to-clipboard"),ve=require("sanity/router"),be=require("react-file-icon"),je=require("react-select/creatable"),Ie=require("date-fns/formatRelative"),Ce=require("react-dropzone");function we(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function Te(e){if(e&&"object"==typeof e&&"default"in e)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)}var ke=we(J),Se=we(ee),_e=we(re),Ee=we(de),Me=we(ue),Re=Te(ge),Be=we(fe),De=we(xe),ze=we(ye),Fe=we(je),Ae=we(Ie);const qe=(e,t)=>{const n=Z.useRef(!1);function a(a){ke.default(e,a)&&(n.current=!0,t&&t())}const i=()=>{n.current=!1};return Z.useEffect((()=>(window.addEventListener("keydown",a),window.addEventListener("keyup",i),()=>{window.removeEventListener("keydown",a),window.removeEventListener("keyup",i)})),[]),n},Oe={type:"divider"},Le={altText:{assetTypes:["file","image"],field:"altText",name:"altText",operatorType:"empty",operatorTypes:["empty","notEmpty",null,"includes","doesNotInclude"],title:"Alt text",type:"string",value:""},description:{assetTypes:["file","image"],field:"description",name:"description",operatorType:"empty",operatorTypes:["empty","notEmpty",null,"includes","doesNotInclude"],title:"Description",type:"string",value:""},fileName:{assetTypes:["file","image"],field:"originalFilename",name:"filename",operatorType:"includes",operatorTypes:["includes","doesNotInclude"],title:"File name",type:"string",value:""},height:{assetTypes:["image"],field:"metadata.dimensions.height",name:"height",operatorType:"greaterThan",operatorTypes:["greaterThan","greaterThanOrEqualTo","lessThan","lessThanOrEqualTo",null,"equalTo"],title:"Height",type:"number",value:400},inCurrentDocument:{assetTypes:["file","image"],name:"inCurrentDocument",operatorType:"is",options:[{name:"true",title:"True",value:Se.default(t||(t=Y(["_id in $documentAssetIds"])))},{name:"false",title:"False",value:Se.default(n||(n=Y(["!(_id in $documentAssetIds)"])))}],selectOnly:!0,title:"In use in current document",type:"select",value:"true"},inUse:{assetTypes:["file","image"],name:"inUse",operatorType:"is",options:[{name:"true",title:"True",value:Se.default(a||(a=Y(["count(*[references(^._id)]) > 0"])))},{name:"false",title:"False",value:Se.default(i||(i=Y(["count(*[references(^._id)]) == 0"])))}],title:"In use",type:"select",value:"true"},isOpaque:{assetTypes:["image"],field:"metadata.isOpaque",name:"isOpaque",operatorType:"equalTo",options:[{name:"true",title:"True",value:"false"},{name:"false",title:"False",value:"true"}],title:"Has transparency",type:"select",value:"true"},orientation:{assetTypes:["image"],name:"orientation",operatorType:"is",operatorTypes:["is","isNot"],options:[{name:"portrait",title:"Portrait",value:"metadata.dimensions.aspectRatio < 1"},{name:"landscape",title:"Landscape",value:"metadata.dimensions.aspectRatio > 1"},{name:"square",title:"Square",value:"metadata.dimensions.aspectRatio == 1"}],title:"Orientation",type:"select",value:"portrait"},size:{assetTypes:["file","image"],field:"size",modifier:"kb",modifiers:[{name:"kb",title:"KB",fieldModifier:e=>"round(".concat(e," / 1000)")},{name:"mb",title:"MB",fieldModifier:e=>"round(".concat(e," / 1000000)")}],name:"size",operatorType:"greaterThan",operatorTypes:["greaterThan","greaterThanOrEqualTo","lessThan","lessThanOrEqualTo",null,"equalTo"],title:"File size",type:"number",value:0},tag:{assetTypes:["file","image"],field:"opt.media.tags",name:"tag",operatorType:"references",operatorTypes:["references","doesNotReference",null,"empty","notEmpty"],title:"Tags",type:"searchable"},title:{assetTypes:["file","image"],field:"title",name:"title",operatorType:"empty",operatorTypes:["empty","notEmpty",null,"includes","doesNotInclude"],title:"Title",type:"string",value:""},type:{assetTypes:["file","image"],name:"type",operatorType:"is",operatorTypes:["is","isNot"],options:[{name:"image",title:"Image",value:'mimeType match "image*"'},{name:"video",title:"Video",value:'mimeType match "video*"'},{name:"audio",title:"Audio",value:'mimeType match "audio*"'},{name:"pdf",title:"PDF",value:'mimeType == "application/pdf"'}],title:"File type",type:"select",value:"image"},width:{assetTypes:["image"],field:"metadata.dimensions.width",name:"width",operatorType:"greaterThan",operatorTypes:["greaterThan","greaterThanOrEqualTo","lessThan","lessThanOrEqualTo",null,"equalTo"],title:"Width",type:"number",value:400}},Pe={doesNotInclude:{fn:(e,t)=>e?"!(".concat(t," match '*").concat(e,"*')"):void 0,label:"does not include"},doesNotReference:{fn:(e,t)=>e?"!references('".concat(e,"')"):void 0,label:"does not include"},empty:{fn:(e,t)=>"!defined(".concat(t,")"),hideInput:!0,label:"is empty"},equalTo:{fn:(e,t)=>e?"".concat(t," == ").concat(e):void 0,label:"is equal to"},greaterThan:{fn:(e,t)=>e?"".concat(t," > ").concat(e):void 0,label:"is greater than"},greaterThanOrEqualTo:{fn:(e,t)=>e?"".concat(t," >= ").concat(e):void 0,label:"is greater than or equal to"},includes:{fn:(e,t)=>e?"".concat(t," match '*").concat(e,"*'"):void 0,label:"includes"},is:{fn:(e,t)=>"".concat(e),label:"is"},isNot:{fn:(e,t)=>"!(".concat(e,")"),label:"is not"},lessThan:{fn:(e,t)=>e?"".concat(t," < ").concat(e):void 0,label:"is less than"},lessThanOrEqualTo:{fn:(e,t)=>e?"".concat(t," <= ").concat(e):void 0,label:"is less than or equal to"},notEmpty:{fn:(e,t)=>"defined(".concat(t,")"),hideInput:!0,label:"is not empty"},references:{fn:(e,t)=>e?"references('".concat(e,"')"):void 0,label:"includes"}},Ue=[{direction:"desc",field:"_createdAt"},{direction:"asc",field:"_createdAt"},null,{direction:"desc",field:"_updatedAt"},{direction:"asc",field:"_updatedAt"},null,{direction:"asc",field:"originalFilename"},{direction:"desc",field:"originalFilename"},null,{direction:"desc",field:"size"},{direction:"asc",field:"size"}],Ne=[Le.tag,Oe,Le.inUse,Le.inCurrentDocument,Oe,Le.title,Le.altText,Le.description,Oe,Le.isOpaque,Oe,Le.fileName,Le.size,Le.type,Oe,Le.orientation,Le.width,Le.height],Ve="3rem 100px auto 1.5rem",Qe="3rem 100px auto 5.5rem 5.5rem 3.5rem 8.5rem 2rem",Xe=32,He="media.tag",Ye=Z.createContext(void 0),Ge=e=>{const{children:t,onSelect:n}=e,a={onSelect:n};return $.jsx(Ye.Provider,{value:a,children:t})},We=()=>{const e=Z.useContext(Ye);if(void 0===e)throw new Error("useAssetSourceActions must be used within an AssetSourceDispatchProvider");return e},$e=()=>G.useClient({apiVersion:"2022-10-01"}),Ke={_createdAt:{asc:"Last created: Oldest first",desc:"Last created: Newest first"},_updatedAt:{asc:"Last updated: Oldest first",desc:"Last updated: Newest first"},mimeType:{asc:"MIME type: A to Z",desc:"MIME type: Z to A"},originalFilename:{asc:"File name: A to Z",desc:"File name: Z to A"},size:{asc:"File size: Smallest first",desc:"File size: Largest first"}},Ze=(e,t)=>Ke[e][t],Je=e=>function(t){return se.iif((()=>!!e),t.pipe(oe.delay(3e3),oe.mergeMap((e=>Math.random()>.5?se.throwError({message:"Test error",statusCode:500}):se.of(e)))),t)},et=e=>{let{assetTypes:t,searchFacets:n,searchQuery:a}=e;const i=t.map((e=>"sanity.".concat(e,"Asset"))),l=Se.default(s||(s=Y(["\n    _type in ",' && !(_id in path("drafts.**"))\n  '])),JSON.stringify(i)),r=n.reduce(((e,t)=>{var n;if("number"===t.type){const{field:n,modifier:a,modifiers:i,operatorType:s,value:o}=t,l=Pe[s],r=null==i?void 0:i.find((e=>e.name===a)),d=(null==r?void 0:r.fieldModifier)?r.fieldModifier(n):n,c=l.fn(o,d);c&&e.push(c)}if("searchable"===t.type){const{field:n,operatorType:a,value:i}=t,s=Pe[a].fn(null==i?void 0:i.value,n);s&&e.push(s)}if("select"===t.type){const{field:a,operatorType:i,options:s,value:o}=t,l=Pe[i],r=null==(n=null==s?void 0:s.find((e=>e.name===o)))?void 0:n.value,d=l.fn(r,a);d&&e.push(d)}if("string"===t.type){const{field:n,operatorType:a,value:i}=t,s=Pe[a].fn(i,n);s&&e.push(s)}return e}),[]);return[l,...a?[Se.default(o||(o=Y(["[_id, altText, assetId, description, originalFilename, title, url] match '*","*'"])),a.trim())]:[],...r].join(" && ")},tt=(e,t)=>function(n){return n.pipe(oe.mergeMap((()=>se.from(e.fetch(Se.default(l||(l=Y(['count(*[_type == "','" && name.current == $name])'])),He),{name:t})))),oe.mergeMap((e=>e>0?se.throwError({message:"Tag already exists",statusCode:409}):se.of(!0))))},nt=e=>e.reduce(((e,t)=>{var n;const a=null==t?void 0:t.tag;return a&&e.push({label:null==(n=null==a?void 0:a.name)?void 0:n.current,value:null==a?void 0:a._id}),e}),[]),at={tagsAddComplete:ne.createAction("actions/tagsAddComplete",(function(e){let{assets:t,tag:n}=e;return{payload:{assets:t,tag:n}}})),tagsAddError:ne.createAction("actions/tagsAddError",(function(e){let{assets:t,error:n,tag:a}=e;return{payload:{assets:t,error:n,tag:a}}})),tagsAddRequest:ne.createAction("actions/tagsAddRequest",(function(e){let{assets:t,tag:n}=e;return{payload:{assets:t,tag:n}}})),tagsRemoveComplete:ne.createAction("actions/tagsRemoveComplete",(function(e){let{assets:t,tag:n}=e;return{payload:{assets:t,tag:n}}})),tagsRemoveError:ne.createAction("actions/tagsRemoveError",(function(e){let{assets:t,error:n,tag:a}=e;return{payload:{assets:t,error:n,tag:a}}})),tagsRemoveRequest:ne.createAction("actions/tagsRemoveRequest",(function(e){let{assets:t,tag:n}=e;return{payload:{assets:t,tag:n}}}))},it={showTagCreate:ne.createAction("dialog/showTagCreate"),showTagEdit:ne.createAction("dialog/showTagEdit",(function(e){let{tagId:t}=e;return{payload:{tagId:t}}}))},st=ne.createSlice({name:"tags",initialState:{allIds:[],byIds:{},creating:!1,creatingError:void 0,fetchCount:-1,fetching:!1,fetchingError:void 0,panelVisible:!0},extraReducers:e=>{e.addCase(it.showTagCreate,(e=>{delete e.creatingError})).addCase(it.showTagEdit,((e,t)=>{const{tagId:n}=t.payload;delete e.byIds[n].error})).addMatcher((e=>[at.tagsAddComplete.type,at.tagsAddError.type,at.tagsRemoveComplete.type,at.tagsRemoveError.type].includes(e.type)),((e,t)=>{const{tag:n}=t.payload;e.byIds[n._id].updating=!1})).addMatcher((e=>[at.tagsAddRequest.type,at.tagsRemoveRequest.type].includes(e.type)),((e,t)=>{const{tag:n}=t.payload;e.byIds[n._id].updating=!0}))},reducers:{createComplete(e,t){const{tag:n}=t.payload;e.creating=!1,e.allIds.includes(n._id)||e.allIds.push(n._id),e.byIds[n._id]={_type:"tag",picked:!1,tag:n,updating:!1}},createError(e,t){e.creating=!1,e.creatingError=t.payload.error},createRequest(e,t){e.creating=!0,delete e.creatingError},deleteComplete(e,t){const{tagId:n}=t.payload,a=e.allIds.indexOf(n);a>=0&&e.allIds.splice(a,1),delete e.byIds[n]},deleteError(e,t){const{error:n,tag:a}=t.payload,i=null==a?void 0:a._id;e.byIds[i].error=n,e.byIds[i].updating=!1},deleteRequest(e,t){var n,a;const i=null==(a=null==(n=t.payload)?void 0:n.tag)?void 0:a._id;e.byIds[i].picked=!1,e.byIds[i].updating=!0,Object.keys(e.byIds).forEach((t=>{delete e.byIds[t].error}))},fetchComplete(e,t){const{tags:n}=t.payload;null==n||n.forEach((t=>{e.allIds.push(t._id),e.byIds[t._id]={_type:"tag",picked:!1,tag:t,updating:!1}})),e.fetching=!1,e.fetchCount=n.length||0,delete e.fetchingError},fetchError(e,t){const{error:n}=t.payload;e.fetching=!1,e.fetchingError=n},fetchRequest:{reducer:(e,t)=>{e.fetching=!0,delete e.fetchingError},prepare:()=>({payload:{query:Se.default(r||(r=Y(['\n          {\n            "items": *[\n              _type == "','"\n              && !(_id in path("drafts.**"))\n            ] {\n              _createdAt,\n              _updatedAt,\n              _id,\n              _rev,\n              _type,\n              name\n            } | order(name.current asc),\n          }\n        '])),He)}})},listenerCreateQueue(e,t){},listenerCreateQueueComplete(e,t){const{tags:n}=t.payload;null==n||n.forEach((t=>{e.byIds[t._id]={_type:"tag",picked:!1,tag:t,updating:!1},e.allIds.includes(t._id)||e.allIds.push(t._id)}))},listenerDeleteQueue(e,t){},listenerDeleteQueueComplete(e,t){const{tagIds:n}=t.payload;null==n||n.forEach((t=>{const n=e.allIds.indexOf(t);n>=0&&e.allIds.splice(n,1),delete e.byIds[t]}))},listenerUpdateQueue(e,t){},listenerUpdateQueueComplete(e,t){const{tags:n}=t.payload;null==n||n.forEach((t=>{e.byIds[t._id]&&(e.byIds[t._id].tag=t)}))},panelVisibleSet(e,t){const{panelVisible:n}=t.payload;e.panelVisible=n},sort(e){e.allIds.sort(((t,n)=>{const a=e.byIds[t].tag.name.current,i=e.byIds[n].tag.name.current;return a<i?-1:a>i?1:0}))},updateComplete(e,t){const{tag:n}=t.payload;e.byIds[n._id].tag=n,e.byIds[n._id].updating=!1},updateError(e,t){const{error:n,tag:a}=t.payload,i=null==a?void 0:a._id;e.byIds[i].error=n,e.byIds[i].updating=!1},updateRequest(e,t){const{tag:n}=t.payload;e.byIds[null==n?void 0:n._id].updating=!0}}}),ot=e=>e.tags.byIds,lt=ne.createSelector([ot,e=>e.tags.allIds],((e,t)=>t.map((t=>e[t])))),rt=ne.createSelector([ot,(e,t)=>t],((e,t)=>e[t])),dt=st.actions;var ct=st.reducer;const ut=ne.createSlice({name:"search",initialState:{facets:[],query:""},reducers:{facetsAdd(e,t){e.facets.push(t.payload.facet)},facetsClear(e){e.facets=[]},facetsRemove(e,t){e.facets=e.facets.filter((e=>e.name!==t.payload.facetName))},facetsUpdate(e,t){const{modifier:n,name:a,operatorType:i,value:s}=t.payload;e.facets.forEach(((t,o)=>{t.name===a&&("number"===t.type&&n&&(t.modifier=n),i&&(t.operatorType=i),void 0!==s&&(e.facets[o].value=s))}))},querySet(e,t){var n;e.query=null==(n=t.payload)?void 0:n.searchQuery}}}),pt=ne.createSelector((e=>e.search.facets),(e=>!!(null==e?void 0:e.find((e=>"tag"===e.name))))),ht=ne.createSelector([e=>e.tags.byIds,e=>e.search.facets,(e,t)=>t],((e,t,n)=>{var a,i,s;const o=null==t?void 0:t.find((e=>"tag"===e.name));if("searchable"===(null==o?void 0:o.type)){const t=null==(a=o.value)?void 0:a.value;if(t)return(null==(s=null==(i=e[t])?void 0:i.tag)?void 0:s._id)===n&&"references"===(null==o?void 0:o.operatorType)}return!1})),mt=ut.actions;var gt=ut.reducer;const ft={uploadComplete:ne.createAction("uploads/uploadComplete",(function(e){let{asset:t}=e;return{payload:{asset:t}}}))},xt=Ue[0],yt={allIds:[],assetTypes:[],byIds:{},fetchCount:-1,fetching:!1,fetchingError:void 0,lastPicked:void 0,order:{direction:xt.direction,field:xt.field,title:Ze(xt.field,xt.direction)},pageIndex:0,pageSize:50,view:"grid"},vt=ne.createSlice({name:"assets",initialState:yt,extraReducers:e=>{e.addCase(ft.uploadComplete,((e,t)=>{const{asset:n}=t.payload;e.byIds[n._id]={_type:"asset",asset:n,picked:!1,updating:!1}})).addCase(at.tagsAddComplete,((e,t)=>{const{assets:n}=t.payload;n.forEach((t=>{e.byIds[t.asset._id].updating=!1}))})).addCase(at.tagsAddError,((e,t)=>{const{assets:n}=t.payload;n.forEach((t=>{e.byIds[t.asset._id].updating=!1}))})).addCase(at.tagsAddRequest,((e,t)=>{const{assets:n}=t.payload;n.forEach((t=>{e.byIds[t.asset._id].updating=!0}))})).addCase(at.tagsRemoveComplete,((e,t)=>{const{assets:n}=t.payload;n.forEach((t=>{e.byIds[t.asset._id].updating=!1}))})).addCase(at.tagsRemoveError,((e,t)=>{const{assets:n}=t.payload;n.forEach((t=>{e.byIds[t.asset._id].updating=!1}))})).addCase(at.tagsRemoveRequest,((e,t)=>{const{assets:n}=t.payload;n.forEach((t=>{e.byIds[t.asset._id].updating=!0}))}))},reducers:{clear(e){e.allIds=[]},deleteComplete(e,t){const{assetIds:n}=t.payload;null==n||n.forEach((t=>{const n=e.allIds.indexOf(t);n>=0&&e.allIds.splice(n,1),delete e.byIds[t]})),e.pageIndex=Math.floor(e.allIds.length/e.pageSize)-1},deleteError(e,t){var n,a,i,s;const{assetIds:o,error:l}=t.payload,r=null==(s=null==(i=null==(a=null==(n=null==l?void 0:l.response)?void 0:n.body)?void 0:a.error)?void 0:i.items)?void 0:s.map((e=>e.error));null==o||o.forEach((t=>{e.byIds[t].updating=!1})),null==r||r.forEach((t=>{e.byIds[t.id].error=t.description}))},deleteRequest(e,t){const{assets:n}=t.payload;n.forEach((t=>{e.byIds[null==t?void 0:t._id].updating=!0})),Object.keys(e.byIds).forEach((t=>{delete e.byIds[t].error}))},fetchComplete(e,t){var n;const a=(null==(n=t.payload)?void 0:n.assets)||[];a&&a.forEach((t=>{e.allIds.includes(t._id)||e.allIds.push(t._id),e.byIds[t._id]={_type:"asset",asset:t,picked:!1,updating:!1}})),e.fetching=!1,e.fetchCount=a.length||0,delete e.fetchingError},fetchError(e,t){const n=t.payload;e.fetching=!1,e.fetchingError=n},fetchRequest:{reducer:(e,t)=>{e.fetching=!0,delete e.fetchingError},prepare:e=>{let{params:t={},queryFilter:n,selector:a="",sort:i=Se.default(c||(c=Y(["order(_updatedAt desc)"])))}=e;const s=i||a?"|":"";return{payload:{params:t,query:Se.default(u||(u=Y(['\n          {\n            "items": *[',"] {\n              _id,\n              _type,\n              _createdAt,\n              _updatedAt,\n              altText,\n              description,\n              extension,\n              renewDate,\n              isLicensed,\n              metadata {\n                dimensions,\n                exif,\n                isOpaque,\n              },\n              mimeType,\n              opt {\n                media\n              },\n              originalFilename,\n              size,\n              title,\n              url\n            } "," "," ",",\n          }\n        "])),n,s,i,a)}}}},insertUploads(e,t){const{results:n}=t.payload;Object.entries(n).forEach((t=>{let[n,a]=t;a&&!e.allIds.includes(n)&&e.allIds.push(a)}))},listenerCreateQueue(e,t){},listenerCreateQueueComplete(e,t){const{assets:n}=t.payload;null==n||n.forEach((t=>{var n;(null==(n=e.byIds[null==t?void 0:t._id])?void 0:n.asset)&&(e.byIds[t._id].asset=t)}))},listenerDeleteQueue(e,t){},listenerDeleteQueueComplete(e,t){const{assetIds:n}=t.payload;null==n||n.forEach((t=>{const n=e.allIds.indexOf(t);n>=0&&e.allIds.splice(n,1),delete e.byIds[t]}))},listenerUpdateQueue(e,t){},listenerUpdateQueueComplete(e,t){const{assets:n}=t.payload;null==n||n.forEach((t=>{var n;(null==(n=e.byIds[null==t?void 0:t._id])?void 0:n.asset)&&(e.byIds[t._id].asset=t)}))},loadNextPage(){},loadPageIndex(e,t){e.pageIndex=t.payload.pageIndex},orderSet(e,t){var n;e.order=null==(n=t.payload)?void 0:n.order,e.pageIndex=0},pick(e,t){const{assetId:n,picked:a}=t.payload;e.byIds[n].picked=a,e.lastPicked=a?n:void 0},pickAll(e){e.allIds.forEach((t=>{e.byIds[t].picked=!0}))},pickClear(e){e.lastPicked=void 0,Object.values(e.byIds).forEach((t=>{e.byIds[t.asset._id].picked=!1}))},pickRange(e,t){const n=e.allIds.findIndex((e=>e===t.payload.startId)),a=e.allIds.findIndex((e=>e===t.payload.endId)),i=[n,a].sort(((e,t)=>e-t));e.allIds.slice(i[0],i[1]+1).forEach((t=>{e.byIds[t].picked=!0})),e.lastPicked=e.allIds[a]},sort(e){e.allIds.sort(((t,n)=>{const a=e.byIds[t].asset[e.order.field],i=e.byIds[n].asset[e.order.field];return a<i?"asc"===e.order.direction?-1:1:a>i?"asc"===e.order.direction?1:-1:0}))},updateComplete(e,t){const{asset:n}=t.payload;e.byIds[n._id].updating=!1,e.byIds[n._id].asset=n},updateError(e,t){const{asset:n,error:a}=t.payload,i=null==n?void 0:n._id;e.byIds[i].error=a.message,e.byIds[i].updating=!1},updateRequest(e,t){var n,a;const i=null==(a=null==(n=t.payload)?void 0:n.asset)?void 0:a._id;e.byIds[i].updating=!0},viewSet(e,t){var n;e.view=null==(n=t.payload)?void 0:n.view}}}),bt=ne.createSelector([e=>e.assets.byIds,(e,t)=>t],((e,t)=>e[t])),jt=ne.createSelector([e=>e.assets.byIds,e=>e.assets.allIds],((e,t)=>t.map((t=>e[t])))),It=ne.createSelector([jt],(e=>e.length)),Ct=ne.createSelector([jt],(e=>e.filter((e=>null==e?void 0:e.picked)))),wt=ne.createSelector([Ct],(e=>e.length)),Tt=vt.actions;var kt,St,_t=vt.reducer;const Et=re.css(g||(g=Y(["\n  ::-webkit-scrollbar {\n    width: 14px;\n  }\n\n  ::-webkit-scrollbar-thumb {\n    border-radius: 10px;\n    border: 4px solid rgba(0, 0, 0, 0);\n    background: ",";\n    background-clip: padding-box;\n\n    &:hover {\n      background: ",";\n      background-clip: padding-box;\n    }\n  }\n"])),null==(kt=le.hues.gray)?void 0:kt[800].hex,null==(St=le.hues.gray)?void 0:St[400].hex),Mt=re.createGlobalStyle(f||(f=Y(["\n  .media__custom-scrollbar {\n    ",'\n  }\n\n  // @sanity/ui overrides\n\n  // Custom scrollbar on Box (used in Dialogs)\n  div[data-ui="Box"] {\n    ','\n  }\n\n  // Dialog background color\n  div[data-ui="Dialog"] {\n    background-color: rgba(15, 17, 18, 0.9);\n  }\n\n'])),Et,Et),Rt=te.useSelector,Bt=ne.createSlice({name:"dialog",initialState:{items:[]},extraReducers:e=>{e.addCase(it.showTagCreate,(e=>{e.items.push({id:"tagCreate",type:"tagCreate"})})),e.addCase(it.showTagEdit,((e,t)=>{const{tagId:n}=t.payload;e.items.push({id:n,tagId:n,type:"tagEdit"})}))},reducers:{clear(e){e.items=[]},inlineTagCreate(e,t){const{assetId:n,tag:a}=t.payload;e.items.forEach((e=>{"assetEdit"===e.type&&e.assetId===n&&(e.lastCreatedTag={label:a.name.current,value:a._id})}))},inlineTagRemove(e,t){const{tagIds:n}=t.payload;e.items.forEach((e=>{"assetEdit"===e.type&&(e.lastRemovedTagIds=n)}))},remove(e,t){var n;const a=null==(n=t.payload)?void 0:n.id;e.items=e.items.filter((e=>e.id!==a))},showConfirmAssetsTagAdd(e,t){const{assetsPicked:n,closeDialogId:a,tag:i}=t.payload,s="".concat(n.length," ").concat(Ee.default("asset",n.length));e.items.push({closeDialogId:a,confirmCallbackAction:at.tagsAddRequest({assets:n,tag:i}),confirmText:"Yes, add tag to ".concat(s),title:"Add tag ".concat(i.name.current," to ").concat(s,"?"),id:"confirm",headerTitle:"Confirm tag addition",tone:"primary",type:"confirm"})},showConfirmAssetsTagRemove(e,t){const{assetsPicked:n,closeDialogId:a,tag:i}=t.payload,s="".concat(n.length," ").concat(Ee.default("asset",n.length));e.items.push({closeDialogId:a,confirmCallbackAction:at.tagsRemoveRequest({assets:n,tag:i}),confirmText:"Yes, remove tag from ".concat(s),headerTitle:"Confirm tag removal",id:"confirm",title:"Remove tag ".concat(i.name.current," from ").concat(s,"?"),tone:"critical",type:"confirm"})},showConfirmDeleteAssets(e,t){const{assets:n,closeDialogId:a}=t.payload,i="".concat(n.length," ").concat(Ee.default("asset",n.length));e.items.push({closeDialogId:a,confirmCallbackAction:Tt.deleteRequest({assets:n.map((e=>e.asset))}),confirmText:"Yes, delete ".concat(i),description:"This operation cannot be reversed. Are you sure you want to continue?",title:"Permanently delete ".concat(i,"?"),id:"confirm",headerTitle:"Confirm deletion",tone:"critical",type:"confirm"})},showConfirmDeleteTag(e,t){const{closeDialogId:n,tag:a}=t.payload;e.items.push({closeDialogId:n,confirmCallbackAction:dt.deleteRequest({tag:a}),confirmText:"Yes, delete ".concat("tag"),description:"This operation cannot be reversed. Are you sure you want to continue?",title:"Permanently delete ".concat("tag","?"),id:"confirm",headerTitle:"Confirm deletion",tone:"critical",type:"confirm"})},showAssetEdit(e,t){const{assetId:n}=t.payload;e.items.push({assetId:n,id:n,type:"assetEdit"})},showSearchFacets(e){e.items.push({id:"searchFacets",type:"searchFacets"})},showTags(e){e.items.push({id:"tags",type:"tags"})}}}),Dt=Bt.actions;var zt=Bt.reducer;const Ft=()=>{const e=te.useDispatch(),t=Rt((e=>e.assets.view));return $.jsxs(K.Inline,{space:0,style:{whiteSpace:"nowrap"},children:[$.jsx(K.Button,{fontSize:1,icon:W.ThLargeIcon,mode:"grid"===t?"default":"ghost",onClick:()=>e(Tt.viewSet({view:"grid"})),style:{borderBottomRightRadius:0,borderTopRightRadius:0}}),$.jsx(K.Button,{fontSize:1,icon:W.ThListIcon,mode:"table"===t?"default":"ghost",onClick:()=>e(Tt.viewSet({view:"table"})),style:{borderBottomLeftRadius:0,borderTopLeftRadius:0}})]})},At=()=>{var e;const t=te.useDispatch(),n=Rt((e=>e.assets.order));return $.jsx(K.MenuButton,{button:$.jsx(K.Button,{fontSize:1,icon:W.SortIcon,iconRight:W.SelectIcon,mode:"ghost",padding:3,text:Ze(n.field,n.direction)}),id:"order",menu:$.jsx(K.Menu,{children:null==(e=Ue)?void 0:e.map(((e,a)=>e?$.jsx(K.MenuItem,{disabled:n.field===e.field&&n.direction===e.direction,fontSize:1,onClick:()=>t(Tt.orderSet({order:{direction:e.direction,field:e.field}})),padding:2,text:Ze(e.field,e.direction)},a):$.jsx(K.MenuDivider,{},a)))})})},qt=e=>{const{loading:t}=e,{animationDuration:n,isFinished:a,progress:i}=ce.useNProgress({animationDuration:300,isAnimating:t});return $.jsx(K.Box,{style:{opacity:a?0:1,transition:"opacity ".concat(n,"ms linear")},children:$.jsx(K.Box,{style:{height:"1px",background:"rgba(255, 255, 255, 0.5)",position:"absolute",left:0,top:0,transition:"width ".concat(n,"ms linear"),width:"".concat(100*i,"%")}})})},Ot=_e.default(K.Box)(x||(x=Y(["\n  background: rgba(255, 255, 255, 0.05);\n  border-radius: ","px;\n"])),(e=>e.theme.sanity.radius[2])),Lt=e=>{const{children:t,facet:n}=e,a=te.useDispatch();return $.jsx(Ot,{padding:[2,2,1],children:$.jsxs(K.Flex,{align:["flex-start","flex-start","center"],direction:["column","column","row"],children:[$.jsx(K.Box,{paddingBottom:[3,3,0],paddingLeft:1,paddingRight:2,paddingTop:[1,1,0],children:$.jsx(K.Label,{size:0,style:{whiteSpace:"nowrap"},children:n.title})}),$.jsxs(K.Flex,{align:"center",children:[t,$.jsx(K.Box,{marginLeft:1,paddingX:2,children:$.jsx(K.Text,{muted:!0,size:0,children:$.jsx(W.CloseIcon,{onClick:()=>{a(mt.facetsRemove({facetName:n.name}))}})})})]})]})})},Pt=t=>{const{onValueChange:n,value:a}=t,i=V(t,e);return $.jsx(K.TextInput,X(X({},i),{},{onChange:e=>{const t=e.target.value;(""===t||/^[0-9\b]+$/.test(t))&&n(parseInt(t,10)||"")},value:null!=a?a:""}))},Ut=e=>{var t;const{facet:n}=e,a=te.useDispatch(),i=null==n?void 0:n.modifiers,s=(null==n?void 0:n.modifier)?null==i?void 0:i.find((e=>e.name===(null==n?void 0:n.modifier))):null==i?void 0:i[0],o=null!=(t=n.operatorType)?t:"greaterThan";return $.jsxs(Lt,{facet:n,children:[(null==n?void 0:n.operatorTypes)&&$.jsx(K.MenuButton,{button:$.jsx(K.Button,{fontSize:1,iconRight:W.SelectIcon,padding:2,text:Pe[o].label}),id:"operators",menu:$.jsx(K.Menu,{children:n.operatorTypes.map(((e,t)=>e?$.jsx(K.MenuItem,{disabled:e===o,fontSize:1,onClick:()=>(e=>{a(mt.facetsUpdate({name:n.name,operatorType:e}))})(e),padding:2,text:Pe[e].label},e):$.jsx(K.MenuDivider,{},t)))})}),$.jsx(K.Box,{marginX:1,style:{maxWidth:"50px"},children:$.jsx(Pt,{fontSize:1,onValueChange:e=>{a(mt.facetsUpdate({name:n.name,value:e}))},padding:2,radius:2,width:2,value:null==n?void 0:n.value})}),i&&$.jsx(K.MenuButton,{button:$.jsx(K.Button,{fontSize:1,iconRight:W.SelectIcon,padding:2,text:null==s?void 0:s.title}),id:"modifier",menu:$.jsx(K.Menu,{children:i.map((e=>$.jsx(K.MenuItem,{disabled:e.name===n.modifier,fontSize:1,onClick:()=>(e=>{a(mt.facetsUpdate({name:n.name,modifier:e.name}))})(e),padding:2,text:e.title},e.name)))})})]})},Nt=e=>{var t;const{facet:n}=e,a=te.useDispatch(),i=null==n?void 0:n.options,s=null==i?void 0:i.find((e=>e.name===(null==n?void 0:n.value))),o=null!=(t=null==n?void 0:n.operatorType)?t:"is";return $.jsxs(Lt,{facet:n,children:[(null==n?void 0:n.operatorTypes)&&$.jsx(K.MenuButton,{button:$.jsx(K.Button,{fontSize:1,iconRight:W.SelectIcon,padding:2,style:{marginRight:"4px"},text:Pe[o].label}),id:"operators",menu:$.jsx(K.Menu,{children:n.operatorTypes.map(((e,t)=>e?$.jsx(K.MenuItem,{disabled:e===o,fontSize:1,onClick:()=>(e=>{a(mt.facetsUpdate({name:n.name,operatorType:e}))})(e),padding:2,text:Pe[e].label},e):$.jsx(K.MenuDivider,{},t)))})}),$.jsx(K.MenuButton,{button:$.jsx(K.Button,{fontSize:1,iconRight:W.SelectIcon,padding:2,text:null==s?void 0:s.title}),id:"list",menu:$.jsx(K.Menu,{children:null==i?void 0:i.map(((e,t)=>$.jsx(K.MenuItem,{disabled:e.name===(null==s?void 0:s.name),fontSize:1,onClick:()=>{return e=i[t],void a(mt.facetsUpdate({name:n.name,value:e.name}));var e},padding:2,text:e.title},e.name)))})})]})},Vt=e=>{const{facet:t}=e,n=te.useDispatch(),a=t.operatorType;return $.jsxs(Lt,{facet:t,children:[(null==t?void 0:t.operatorTypes)&&$.jsx(K.MenuButton,{button:$.jsx(K.Button,{fontSize:1,iconRight:W.SelectIcon,padding:2,text:Pe[a].label}),id:"operators",menu:$.jsx(K.Menu,{children:t.operatorTypes.map(((e,i)=>e?$.jsx(K.MenuItem,{disabled:e===a,fontSize:1,onClick:()=>(e=>{n(mt.facetsUpdate({name:t.name,operatorType:e}))})(e),padding:2,text:Pe[e].label},e):$.jsx(K.MenuDivider,{},i)))})}),!Pe[a].hideInput&&$.jsx(K.Box,{marginLeft:1,style:{maxWidth:"125px"},children:$.jsx(K.TextInput,{fontSize:1,onChange:e=>{n(mt.facetsUpdate({name:t.name,value:e.target.value}))},padding:2,radius:2,width:2,value:null==t?void 0:t.value})})]})};var Qt,Xt,Ht,Yt,Gt,Wt,$t,Kt,Zt,Jt,en,tn,nn,an,sn;const on=null==(Gt=null==(Yt=null==(Ht=null==(Xt=null==(Qt=K.studioTheme)?void 0:Qt.color)?void 0:Xt.dark)?void 0:Ht.primary)?void 0:Yt.spot)?void 0:Gt.blue,ln=null==(Jt=null==(Zt=null==(Kt=null==($t=null==(Wt=K.studioTheme)?void 0:Wt.color)?void 0:$t.dark)?void 0:Kt.default)?void 0:Zt.base)?void 0:Jt.bg,rn=null==(en=K.studioTheme)?void 0:en.radius,dn=null==(tn=K.studioTheme)?void 0:tn.space,cn=null==(sn=null==(an=null==(nn=K.studioTheme)?void 0:nn.fonts)?void 0:an.text)?void 0:sn.sizes,un={control:(e,t)=>{let{isDisabled:n,isFocused:a}=t,i="inset 0 0 0 1px ".concat(le.hues.gray[900].hex);return a&&(i="inset 0 0 0 1px ".concat(le.hues.gray[900].hex,", 0 0 0 1px var(--card-bg-color), 0 0 0 3px var(--card-focus-ring-color) !important")),X(X({},e),{},{backgroundColor:ln,color:le.white.hex,border:"none",borderRadius:rn[2],boxShadow:i,fontSize:cn[1].fontSize,minHeight:"25px",opacity:n?.5:"inherit",outline:"none",transition:"none","&:hover":{boxShadow:"inset 0 0 0 1px ".concat(K.studioTheme.color.dark.default.input.default.hovered.border)}})},input:e=>X(X({},e),{},{color:le.white.hex,fontFamily:K.studioTheme.fonts.text.family,marginLeft:dn[2]}),menuList:e=>X(X({},e),{},{padding:0}),noOptionsMessage:e=>X(X({},e),{},{fontFamily:K.studioTheme.fonts.text.family,fontSize:cn[1].fontSize,lineHeight:"1em"}),option:(e,t)=>{let{isFocused:n}=t;return X(X({},e),{},{backgroundColor:n?on:"transparent",borderRadius:rn[2],color:n?le.black.hex:"inherit",fontSize:cn[1].fontSize,lineHeight:"1em",padding:"4px 6px","&:hover":{backgroundColor:on,color:le.black.hex}})},placeholder:e=>X(X({},e),{},{fontFamily:K.studioTheme.fonts.text.family,marginLeft:dn[2],paddingBottom:"2px"}),singleValue:e=>X(X({},e),{},{color:le.white.hex,lineHeight:"1em",paddingBottom:"1px"}),valueContainer:e=>X(X({},e),{},{margin:0,padding:0})},pn=e=>$.jsx(K.Box,{padding:1,children:$.jsx(ue.components.Option,X(X({},e),{},{children:$.jsx(K.Box,{paddingY:1,children:$.jsx(K.Text,{size:1,style:{color:"inherit"},textOverflow:"ellipsis",children:e.children})})}))}),hn={ClearIndicator:e=>$.jsx(ue.components.ClearIndicator,X(X({},e),{},{children:$.jsx(K.Box,{paddingRight:1,style:{transform:"scale(0.85)"},children:$.jsx(K.Text,{muted:!0,size:0,children:$.jsx(W.CloseIcon,{})})})})),DropdownIndicator:null,IndicatorSeparator:null,Menu:e=>$.jsx(ue.components.Menu,X(X({},e),{},{children:$.jsx(K.Card,{radius:1,shadow:2,children:e.children})})),MenuList:e=>{const{children:t}=e;if(Array.isArray(t)){const e=t.length>5?165:33*t.length;return $.jsx(pe.Virtuoso,{className:"media__custom-scrollbar",itemContent:e=>{const n=t[e];return $.jsx(pn,X({},n.props))},style:{height:e},totalCount:t.length})}return $.jsx(ue.components.MenuList,X(X({},e),{},{children:t}))},NoOptionsMessage:e=>$.jsx(ue.components.NoOptionsMessage,X(X({},e),{},{children:e.children})),Option:pn,SingleValue:e=>$.jsx(ue.components.SingleValue,X(X({},e),{},{children:$.jsx(K.Box,{paddingLeft:2,children:$.jsx(K.Text,{size:1,style:{color:"inherit",lineHeight:"2em"},textOverflow:"ellipsis",children:e.children})})}))},mn=e=>{const{facet:t}=e,n=te.useDispatch(),a=Rt((e=>lt(e))),i=Rt((e=>e.tags.fetching)),s=nt(a),o=t.operatorType;return $.jsxs(Lt,{facet:t,children:[(null==t?void 0:t.operatorTypes)&&$.jsx(K.MenuButton,{button:$.jsx(K.Button,{fontSize:1,iconRight:W.SelectIcon,padding:2,text:Pe[o].label}),id:"operators",menu:$.jsx(K.Menu,{children:t.operatorTypes.map(((e,a)=>e?$.jsx(K.MenuItem,{disabled:e===o,fontSize:1,onClick:()=>(e=>{n(mt.facetsUpdate({name:t.name,operatorType:e}))})(e),padding:2,text:Pe[e].label},e):$.jsx(K.MenuDivider,{},a)))})}),!Pe[o].hideInput&&$.jsx(K.Box,{marginX:1,style:{width:"160px"},children:$.jsx(Me.default,{components:hn,instanceId:"facet-searchable",isClearable:!0,isDisabled:i,isSearchable:!0,name:"tags",noOptionsMessage:()=>"No tags",onChange:e=>{return a=e,void n(mt.facetsUpdate({name:t.name,value:a}));var a},options:s,placeholder:i?"Loading...":"Select...",styles:un,value:null==t?void 0:t.value})})]})},gn=_e.default(K.Flex)(y||(y=Y(["\n  > * {\n    margin-bottom: ","px;\n  }\n"])),(e=>e.theme.sanity.space[2])),fn=e=>{const{layout:t="inline"}=e,n=Rt((e=>e.search.facets)),a=n.map((e=>"number"===e.type?$.jsx(Ut,{facet:e},e.name):"searchable"===e.type?$.jsx(mn,{facet:e},e.name):"select"===e.type?$.jsx(Nt,{facet:e},e.name):"string"===e.type?$.jsx(Vt,{facet:e},e.name):null));if("inline"===t)return 0===n.length?null:$.jsx(K.Box,{marginBottom:2,children:$.jsx(K.Inline,{space:2,children:a})});if("stack"===t)return $.jsx(gn,{align:"flex-start",direction:"column",children:a});throw Error("Invalid layout")},xn=()=>{const e=te.useDispatch(),t=Rt((e=>e.assets.assetTypes)),n=Rt((e=>e.search.facets)),a=!Rt((e=>e.selected.document)),i=Ne.filter((e=>{if("group"===e.type||"divider"===e.type)return!0;if(a)return!(null==e?void 0:e.selectOnly);return e.assetTypes.filter((e=>t.includes(e))).length>0})).filter(((e,t,n)=>{const a=n[t-1];return("divider"!==e.type||0!==t&&t!==n.length-1)&&("divider"!==e.type||"divider"!==(null==a?void 0:a.type))})),s=i.filter((e=>e)).length-n.length>0,o=function(t){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return $.jsx($.Fragment,{children:null==t?void 0:t.map(((t,i)=>{if("divider"===t.type)return $.jsx(K.MenuDivider,{},i);if("group"===t.type)return $.jsx(K.MenuGroup,{text:t.title,title:t.title,children:o(t.facets,a+1)},"group-".concat(a,"-").concat(i));if(t){const a=!!n.find((e=>e.name===t.name));return $.jsx(K.MenuItem,{disabled:a,fontSize:1,onClick:()=>e(mt.facetsAdd({facet:t})),padding:2,text:t.title},t.name)}return null}))})};return $.jsxs(K.Flex,{children:[$.jsx(K.MenuButton,{button:$.jsx(K.Button,{disabled:!s,fontSize:1,icon:W.AddCircleIcon,mode:"bleed",text:"Add filter",tone:"primary"}),id:"facets",menu:$.jsx(K.Menu,{children:o(i)}),placement:"right-start",portal:!0}),n.length>0&&$.jsx(K.Button,{fontSize:1,mode:"bleed",onClick:()=>e(mt.facetsClear()),text:"Clear"})]})},yn=()=>$.jsxs("svg",{"data-sanity-icon":"media__tag",fill:"currentColor",height:"1em",stroke:"currentColor",strokeWidth:"0",viewBox:"0 0 512 512",width:"1em",children:[$.jsx("path",{d:"M435.25 48h-122.9a14.46 14.46 0 00-10.2 4.2L56.45 297.9a28.85 28.85 0 000 40.7l117 117a28.85 28.85 0 0040.7 0L459.75 210a14.46 14.46 0 004.2-10.2v-123a28.66 28.66 0 00-28.7-28.8z",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32"}),$.jsx("path",{d:"M384 160a32 32 0 1132-32 32 32 0 01-32 32z"})]}),vn=()=>{const e=Rt((e=>e.search.query)),t=te.useDispatch();return $.jsxs(K.Box,{style:{position:"relative"},children:[$.jsx(K.TextInput,{fontSize:1,icon:W.SearchIcon,onChange:e=>{t(mt.querySet({searchQuery:e.currentTarget.value}))},placeholder:"Search",radius:2,value:e}),e.length>0&&$.jsx(K.Flex,{align:"center",justify:"center",onClick:()=>{t(mt.querySet({searchQuery:""}))},style:{cursor:"pointer",height:"100%",opacity:.75,position:"absolute",right:0,top:0,width:"2em",zIndex:1},children:$.jsx(W.CloseIcon,{})})]})},bn=()=>{var e;const t=te.useDispatch(),n=Rt((e=>e.assets.fetching)),a=Rt((e=>e.assets.pageIndex)),i=Rt((e=>e.search.facets)),s=Rt((e=>e.tags.panelVisible)),o=K.useMediaIndex();return $.jsxs(K.Box,{paddingY:2,style:{borderBottom:"1px solid ".concat(null==(e=le.hues.gray)?void 0:e[900].hex),zIndex:2},children:[$.jsx(K.Box,{marginBottom:2,children:$.jsx(K.Flex,{align:"flex-start",direction:["column","column","column","column","row"],justify:"space-between",children:$.jsxs(K.Flex,{flex:1,style:{alignItems:"flex-start",flex:1,height:"100%",justifyContent:o<2?"space-between":"flex-start",position:"relative",width:"100%"},children:[$.jsx(K.Box,{marginX:2,style:{minWidth:"200px"},children:$.jsx(vn,{})}),$.jsxs(K.Box,{display:["none","none","block"],children:[$.jsx(fn,{}),$.jsx(xn,{})]}),$.jsx(K.Box,{display:["block","block","none"],marginX:2,children:$.jsxs(K.Inline,{space:2,style:{whiteSpace:"nowrap"},children:[$.jsx(K.Button,{fontSize:1,mode:"ghost",onClick:()=>{t(Dt.showSearchFacets())},text:"Filters".concat(i.length>0?" (".concat(i.length,")"):""),tone:"primary"}),$.jsx(K.Button,{fontSize:1,mode:"ghost",onClick:()=>{t(Dt.showTags())},text:"Tags",tone:"primary"})]})})]})})}),$.jsx(K.Box,{children:$.jsxs(K.Flex,{align:"center",justify:["space-between"],children:[$.jsx(K.Box,{marginX:2,children:$.jsx(Ft,{})}),$.jsxs(K.Flex,{marginX:2,children:[$.jsx(At,{}),$.jsx(K.Box,{display:["none","none","block"],marginLeft:2,children:$.jsx(K.Button,{fontSize:1,icon:$.jsx(K.Box,{style:{transform:"scale(0.75)"},children:$.jsx(yn,{})}),onClick:()=>{t(dt.panelVisibleSet({panelVisible:!s}))},mode:s?"default":"ghost",text:s?"Tags":""})})]})]})}),$.jsx(qt,{loading:n},a)]})},jn=ne.createSlice({name:"debug",initialState:{badConnection:!1,enabled:!1},reducers:{setBadConnection(e,t){e.badConnection=t.payload},toggleEnabled(e){e.enabled=!e.enabled}}}),In=jn.actions;var Cn=jn.reducer;const wn=()=>{const e=te.useDispatch(),t=Rt((e=>e.debug.badConnection)),n=Rt((e=>e.debug.enabled));return qe("alt+ctrl+shift+/",(()=>{e(In.toggleEnabled())})),n?$.jsx(K.Box,{padding:4,style:{bottom:0,left:0,pointerEvents:"none",position:"fixed",width:"100%"},children:$.jsxs(K.Flex,{align:"center",children:[$.jsx(K.Box,{marginRight:3,children:$.jsx(K.Text,{muted:!0,size:1,children:$.jsx(W.PlugIcon,{})})}),$.jsx(K.Tooltip,{content:$.jsx(K.Box,{padding:2,children:$.jsx(K.Text,{muted:!0,size:1,children:t?"Bad connection: +3000ms & 50% chance to fail":"No connection throttling"})}),fallbackPlacements:["right","left"],placement:"bottom",children:$.jsx(K.Switch,{checked:t,onChange:t=>{const n=t.target.checked;e(In.setBadConnection(n))},style:{pointerEvents:"auto"}})})]})}):null},Tn=(e,t)=>{const n="undefined"!=typeof window&&window.devicePixelRatio?Math.round(window.devicePixelRatio):1,a=(null==t?void 0:t.height)?(null==t?void 0:t.height)*Math.max(1,n):void 0,i=t.width*Math.max(1,n),s=new URLSearchParams;return s.append("fit","max"),s.append("w",i.toString()),a&&s.append("h",a.toString()),"".concat(e.url,"?").concat(s.toString())},kn=e=>Object.keys(e).reduce(((t,n)=>{const a=e[n];return"object"==typeof a&&null!==a&&a.constructor!==Array?t[n]=kn(a):""===a||void 0===a||0===(null==a?void 0:a.length)?t[n]=null:t[n]="string"==typeof a&&a?e[n].trim():e[n],t}),{}),Sn=e=>"sanity.fileAsset"===e._type,_n=e=>"sanity.imageAsset"===e._type,En=e=>"".concat(e.metadata.dimensions.width,"x").concat(e.metadata.dimensions.height,"px"),Mn=e=>{const{disabled:t,url:n}=e,a=Z.useRef(),[i,s]=Z.useState(!1);return Z.useEffect((()=>()=>{a.current&&clearTimeout(a.current)}),[]),$.jsx(K.Popover,{content:$.jsx(K.Text,{muted:!0,size:1,children:"Copied!"}),open:i,padding:2,placement:"top",radius:1,children:$.jsx(K.Button,{disabled:t,fontSize:1,icon:W.ClipboardIcon,mode:"ghost",onClick:()=>{a.current&&clearTimeout(a.current),s(!0),ze.default(n),a.current=setTimeout((()=>{s(!1)}),1250)},text:"Copy URL"})})},Rn=e=>{let{label:t,value:n}=e;return $.jsxs(K.Flex,{justify:"space-between",children:[$.jsx(K.Text,{size:1,style:{opacity:.8,width:"40%"},textOverflow:"ellipsis",children:t}),$.jsx(K.Text,{size:1,style:{opacity:.4,textAlign:"right",width:"60%"},textOverflow:"ellipsis",children:n})]})},Bn=e=>{var t;const{asset:n,item:a}=e,i=null==(t=null==n?void 0:n.metadata)?void 0:t.exif;return $.jsxs(K.Box,{marginTop:3,children:[$.jsx(K.Box,{children:$.jsxs(K.Stack,{space:3,children:[$.jsx(Rn,{label:"Size",value:De.default(null==n?void 0:n.size,{base:10,round:0})}),$.jsx(Rn,{label:"MIME type",value:null==n?void 0:n.mimeType}),$.jsx(Rn,{label:"Extension",value:(null==n?void 0:n.extension).toUpperCase()}),_n(n)&&$.jsx(Rn,{label:"Dimensions",value:En(n)})]})}),i&&$.jsxs($.Fragment,{children:[$.jsx(K.Box,{marginY:4,style:{background:"#222",height:"1px",width:"100%"}}),$.jsx(K.Box,{children:$.jsxs(K.Stack,{space:3,children:[i.ISO&&$.jsx(Rn,{label:"ISO",value:i.ISO}),i.FNumber&&$.jsx(Rn,{label:"Aperture",value:"Æ’/".concat(i.FNumber)}),i.FocalLength&&$.jsx(Rn,{label:"Focal length",value:"".concat(i.FocalLength,"mm")}),i.ExposureTime&&$.jsx(Rn,{label:"Exposure time",value:"1/".concat(1/i.ExposureTime)}),i.DateTimeOriginal&&$.jsx(Rn,{label:"Original date",value:Be.default(new Date(i.DateTimeOriginal),"PPp")})]})})]}),$.jsx(K.Box,{marginTop:5,children:$.jsxs(K.Inline,{space:2,children:[$.jsx(K.Button,{disabled:!a||(null==a?void 0:a.updating),fontSize:1,icon:W.DownloadIcon,mode:"ghost",onClick:()=>{window.location.href="".concat(n.url,"?dl=").concat(n.originalFilename)},text:"Download"}),$.jsx(Mn,{disabled:!a||(null==a?void 0:a.updating),url:n.url})]})})]})},Dn=e=>$.jsx(K.Dialog,X(X({},e),{},{style:{position:"fixed"}})),zn=e=>{const{assetId:t}=e,n=G.useDocumentStore();return $.jsx(G.WithReferringDocuments,{documentStore:n,id:t,children:e=>{let{isLoading:t,referringDocuments:n}=e;return $.jsx(Fn,{isLoading:t,referringDocuments:n})}})},Fn=e=>{const{isLoading:t,referringDocuments:n}=e,a=G.useSchema(),i=n.reduce(((e,t)=>t._id.startsWith("drafts.")?e.concat(t._id.slice(7)):e),[]),s=n.filter((e=>!i.includes(e._id)));return t?$.jsx(K.Text,{size:1,children:"Loading..."}):0===s.length?$.jsx(K.Text,{size:1,children:"No documents are referencing this asset"}):$.jsx(K.Card,{flex:1,marginBottom:2,padding:2,radius:2,shadow:1,children:$.jsx(K.Stack,{space:2,children:null==s?void 0:s.map((e=>$.jsx(An,{doc:e,schemaType:a.get(e._type)},e._id)))})})},An=e=>{const{doc:t,schemaType:n}=e,{onClick:a}=ve.useIntentLink({intent:"edit",params:{id:t._id}});return n?$.jsx(K.Button,{mode:"bleed",onClick:a,padding:2,style:{width:"100%"},children:$.jsx(G.Preview,{layout:"default",schemaType:n,value:t})},t._id):$.jsx(K.Box,{padding:2,children:$.jsxs(K.Text,{size:1,children:["A document of the unknown type ",$.jsx("em",{children:t._type})]})})},qn=_e.default(K.Box)(v||(v=Y(["\n  text {\n    font-family: "," !important;\n    font-size: 8px !important;\n    font-weight: 500 !important;\n  }\n"])),(e=>e.theme.sanity.fonts.text.family)),On=e=>{const{extension:t,onClick:n,width:a}=e;return $.jsx(K.Flex,{align:"center",justify:"center",onClick:n,style:{height:"100%"},children:$.jsx(qn,{style:{width:a},children:t?$.jsx(be.FileIcon,X({extension:t},be.defaultStyles[t])):$.jsx(be.FileIcon,{})})})},Ln=e=>{const{asset:t}=e;return 0===t.mimeType.search("audio")?$.jsx(K.Flex,{align:"center",justify:"center",style:{height:"100%"},children:$.jsx("audio",{controls:!0,src:t.url,style:{width:"100%"}})}):0===t.mimeType.search("video")?$.jsx("video",{controls:!0,src:t.url,style:{height:"100%",width:"100%"}}):$.jsx(On,{extension:t.extension,width:"50%"})};var Pn,Un,Nn,Vn,Qn,Xn,Hn,Yn,Gn,Wn,$n,Kn;const Zn=null==(Qn=null==(Vn=null==(Nn=null==(Un=null==(Pn=K.studioTheme)?void 0:Pn.color)?void 0:Un.dark)?void 0:Nn.primary)?void 0:Vn.spot)?void 0:Qn.blue,Jn=null==(Wn=null==(Gn=null==(Yn=null==(Hn=null==(Xn=K.studioTheme)?void 0:Xn.color)?void 0:Hn.dark)?void 0:Yn.primary)?void 0:Gn.spot)?void 0:Wn.gray,ea=null==($n=K.studioTheme)?void 0:$n.radius,ta=null==(Kn=K.studioTheme)?void 0:Kn.space,na={control:(e,t)=>{let{isDisabled:n,isFocused:a}=t,i="inset 0 0 0 1px ".concat(le.hues.gray[900].hex);return a&&(i="inset 0 0 0 1px ".concat(le.hues.gray[900].hex,", 0 0 0 1px var(--card-bg-color), 0 0 0 3px var(--card-focus-ring-color) !important")),X(X({},e),{},{background:n?K.studioTheme.color.dark.default.input.default.disabled.bg:"transparent",color:le.white.hex,border:"none",borderRadius:ea[1],boxShadow:i,minHeight:"35px",outline:"none",transition:"none","&:hover":{boxShadow:"inset 0 0 0 1px ".concat(K.studioTheme.color.dark.default.input.default.hovered.border)}})},indicatorsContainer:(e,t)=>{let{isDisabled:n}=t;return X(X({},e),{},{opacity:n?.25:1})},input:e=>X(X({},e),{},{color:le.white.hex,fontFamily:K.studioTheme.fonts.text.family,marginLeft:ta[2]}),menuList:e=>X({},e),multiValue:(e,t)=>{let{isDisabled:n}=t;return X(X({},e),{},{backgroundColor:Jn,borderRadius:ea[2],opacity:n?.5:1})},multiValueRemove:e=>X(X({},e),{},{paddingLeft:0,"&:hover":{background:"transparent",color:"inherit"}}),noOptionsMessage:e=>X(X({},e),{},{fontFamily:K.studioTheme.fonts.text.family,lineHeight:"1em"}),option:(e,t)=>{let{isFocused:n}=t;return X(X({},e),{},{backgroundColor:n?Zn:"transparent",borderRadius:ea[2],color:n?le.black.hex:"inherit",fontFamily:K.studioTheme.fonts.text.family,padding:"4px 8px","&:hover":{backgroundColor:Zn,color:le.black.hex}})},placeholder:e=>X(X({},e),{},{fontFamily:K.studioTheme.fonts.text.family,marginLeft:ta[2]}),valueContainer:e=>X(X({},e),{},{marginBottom:ta[0],marginLeft:ta[1],marginTop:ta[0],padding:0})},aa=e=>$.jsx(K.Box,{paddingX:1,paddingY:1,children:$.jsx(ue.components.Option,X(X({},e),{},{children:$.jsxs(K.Flex,{align:"center",children:[e.data.__isNew__&&$.jsx(W.AddIcon,{style:{marginRight:"3px"}}),e.children]})}))}),ia={DropdownIndicator:e=>$.jsx(ue.components.DropdownIndicator,X(X({},e),{},{children:$.jsx(K.Box,{paddingX:2,children:$.jsx(K.Text,{size:1,children:$.jsx(W.ChevronDownIcon,{})})})})),IndicatorSeparator:null,Menu:e=>$.jsx(ue.components.Menu,X(X({},e),{},{children:$.jsx(K.Card,{radius:1,shadow:2,children:e.children})})),MenuList:e=>{const{children:t}=e;if(Array.isArray(t)){const e=t.length>5?185:37*t.length;return $.jsx(pe.Virtuoso,{className:"media__custom-scrollbar",itemContent:e=>{const n=t[e];return $.jsx(aa,X({},n.props))},style:{height:e},totalCount:t.length})}return $.jsx(ue.components.MenuList,X(X({},e),{},{children:t}))},MultiValueLabel:e=>$.jsx(K.Box,{paddingLeft:1,paddingRight:0,paddingY:1,children:$.jsx(K.Text,{size:2,weight:"medium",children:$.jsx(ue.components.MultiValueLabel,X({},e))})}),MultiValueRemove:e=>$.jsx(ue.components.MultiValueRemove,X(X({},e),{},{children:$.jsx(W.CloseIcon,{color:"#1f2123"})})),Option:aa},sa=_e.default(W.ErrorOutlineIcon)((e=>{let{theme:t}=e;return{color:t.sanity.color.spot.red}})),oa=e=>{const{description:t,error:n,label:a,name:i}=e;return $.jsxs($.Fragment,{children:[$.jsx(K.Box,{marginY:3,children:$.jsxs(K.Inline,{space:2,children:[$.jsx(K.Text,{as:"label",htmlFor:i,size:1,weight:"semibold",children:a}),n&&$.jsx(K.Text,{size:1,children:$.jsx(K.Tooltip,{content:$.jsx(K.Box,{padding:2,children:$.jsxs(K.Text,{muted:!0,size:1,children:[$.jsx(sa,{style:{marginRight:"0.1em"}}),n.message]})}),fallbackPlacements:["top","left"],placement:"right",portal:!0,children:$.jsx(sa,{})})})]})}),t&&$.jsx(K.Box,{marginY:3,children:$.jsx(K.Text,{htmlFor:i,muted:!0,size:1,children:t})})]})},la=e=>{const{control:t,description:n,disabled:a,error:i,label:s,name:o,onCreateTag:l,options:r,placeholder:d,value:c}=e,u=Rt((e=>e.tags.creating)),p=Rt((e=>e.tags.fetching));return $.jsxs(K.Box,{style:{zIndex:2},children:[$.jsx(oa,{description:n,error:i,label:s,name:o}),$.jsx(me.Controller,{control:t,defaultValue:c,name:o,render:e=>{let{onBlur:t,onChange:n,value:i}=e;return $.jsx(Fe.default,{components:ia,instanceId:"tags",isClearable:!1,isDisabled:u||a||p,isLoading:u,isMulti:!0,name:o,noOptionsMessage:()=>"No tags",onBlur:t,onChange:n,onCreateOption:l,options:r,placeholder:p?"Loading...":d,styles:na,value:i})}})]})},ra=Z.forwardRef(((e,t)=>{const{description:n,disabled:a,error:i,type:s,label:o,name:l,placeholder:r,value:d,onChange:c}=e;return $.jsxs(K.Box,{children:[$.jsx(oa,{description:n,error:i,label:o,name:l}),$.jsx(K.TextInput,{autoComplete:"off",autoFocus:!0,defaultValue:d,disabled:a,id:l,onChange:c,type:s,name:l,placeholder:r,ref:t})]})})),da=Z.forwardRef(((e,t)=>{const{description:n,disabled:a,error:i,label:s,name:o,placeholder:l,rows:r,value:d}=e;return $.jsxs(K.Box,{children:[$.jsx(oa,{description:n,error:i,label:s,name:o}),$.jsx(K.TextArea,{autoComplete:"off",defaultValue:d,disabled:a,id:o,name:o,placeholder:l,ref:t,rows:r})]})})),ca=e=>{const{disabled:t,isValid:n,lastUpdated:a,onClick:i}=e;let s;return s=n?a?$.jsxs($.Fragment,{children:["Last updated",$.jsx("br",{})," ",Be.default(new Date(a),"PPp")]}):"No unpublished changes":"There are validation errors that need to be fixed before this document can be published",$.jsx(K.Tooltip,{content:$.jsx(K.Box,{padding:3,style:{maxWidth:"185px"},children:$.jsx(K.Text,{muted:!0,size:1,children:s})}),disabled:"ontouchstart"in window,placement:"top",children:$.jsx(K.Box,{children:$.jsx(K.Button,{disabled:t,fontSize:1,onClick:i,text:"Save and close",tone:"primary"})})})},ua=_e.default.img(b||(b=Y(["\n  --checkerboard-color: ",";\n\n  display: block;\n  width: 100%;\n  height: 100%;\n  object-fit: contain;\n\n  ","\n"])),le.hues.gray[900].hex,(e=>e.showCheckerboard&&re.css(j||(j=Y(["\n      background-image: linear-gradient(45deg, var(--checkerboard-color) 25%, transparent 25%),\n        linear-gradient(-45deg, var(--checkerboard-color) 25%, transparent 25%),\n        linear-gradient(45deg, transparent 75%, var(--checkerboard-color) 75%),\n        linear-gradient(-45deg, transparent 75%, var(--checkerboard-color) 75%);\n      background-size: 20px 20px;\n      background-position: 0 0, 0 10px, 10px -10px, -10px 0;\n    "]))))),pa=Re.object().shape({originalFilename:Re.string().trim().required("Filename cannot be empty")}),ha=e=>{var t,n,a,i;const{children:s,dialog:{assetId:o,id:l,lastCreatedTag:r,lastRemovedTagIds:d}}=e,c=$e(),u=te.useDispatch(),p=Rt((e=>bt(e,String(o)))),h=Rt(lt),m=Z.useRef(!1),[g,f]=Z.useState(null==p?void 0:p.asset),[x,y]=Z.useState("details"),v=p?null==p?void 0:p.asset:g,b=nt(h),j=Rt((w=v,e=>{var t,n,a;const i=null==(a=null==(n=null==(t=null==w?void 0:w.opt)?void 0:t.media)?void 0:n.tags)?void 0:a.reduce(((t,n)=>{const a=e.tags.byIds[n._ref];return(null==a?void 0:a.tag)&&t.push(a),t}),[]);return i&&(null==i?void 0:i.length)>0?nt(i):null}));var w;Z.useState((null==v?void 0:v.isLicensed)||!1);const T=e=>({altText:(null==e?void 0:e.altText)||"",description:(null==e?void 0:e.description)||"",originalFilename:(null==e?void 0:e.originalFilename)||"",opt:{media:{tags:j}},title:(null==e?void 0:e.title)||""}),k=null==j?void 0:j.map((e=>e.label)).join(","),{control:S,formState:{errors:_,isDirty:E,isValid:M},getValues:R,handleSubmit:B,register:D,reset:z,setValue:F}=me.useForm({defaultValues:T(null==p?void 0:p.asset),mode:"onChange",resolver:he.yupResolver(pa)}),A=!p||(null==p?void 0:p.updating),q=()=>{(null==p?void 0:p.asset)&&u(Dt.showConfirmDeleteAssets({assets:[p],closeDialogId:null==p?void 0:p.asset._id}))},O=e=>{const{result:t,transition:n}=e;t&&"update"===n&&(f(t),z(T(t)))},L=async e=>{var t;if(!(null==p?void 0:p.asset))return;const n=kn(e),a={asset:null==p?void 0:p.asset,closeDialogId:null==p?void 0:p.asset._id,formData:X(X({},n),{},{opt:{media:X(X({},n.opt.media),{},{tags:(null==(t=n.opt.media.tags)?void 0:t.map((e=>({_ref:e.value,_type:"reference",_weak:!0}))))||null})}})};u(Tt.updateRequest(a))};Z.useEffect((()=>{if(!(null==p?void 0:p.asset))return;const e=c.listen(Se.default(I||(I=Y(["*[_id == $id]"]))),{id:null==p?void 0:p.asset._id}).subscribe(O);return()=>{null==e||e.unsubscribe()}}),[]),Z.useEffect((()=>{m.current&&z({opt:{media:{tags:j}}},{errors:!0,dirtyFields:!0,isDirty:!0}),m.current=!0}),[k]),Z.useEffect((()=>{if(r){const e=(R("opt.media.tags")||[]).concat([r]);F("opt.media.tags",e,{shouldDirty:!0})}}),[r]),Z.useEffect((()=>{if(d){const e=(R("opt.media.tags")||[]).filter((e=>!d.includes(e.value)));F("opt.media.tags",e,{shouldDirty:!0})}}),[d]),Z.useEffect((()=>{(async()=>{const e=Se.default(C||(C=Y(['*[_type == "resort"]{_id, title, "gallery" : gallery.images[0]  }'])));await c.fetch(e)})()}),[]);const P=()=>$.jsx(K.Box,{padding:3,children:$.jsxs(K.Flex,{justify:"space-between",children:[$.jsx(K.Button,{disabled:A,fontSize:1,mode:"bleed",onClick:q,text:"Delete",tone:"critical"}),$.jsx(ca,{disabled:A||!E||!M,isValid:M,lastUpdated:v._updatedAt,onClick:B(L)})]})});return v?$.jsxs(Dn,{footer:$.jsx(P,{}),header:"Asset details",id:l,onClose:()=>{u(Dt.remove({id:l}))},width:3,children:[$.jsxs(K.Flex,{direction:["column-reverse","column-reverse","row-reverse"],children:[$.jsxs(K.Box,{flex:1,marginTop:[5,5,0],padding:4,children:[$.jsxs(K.TabList,{space:2,children:[$.jsx(K.Tab,{"aria-controls":"details-panel",disabled:A,id:"details-tab",label:"Details",onClick:()=>y("details"),selected:"details"===x,size:2}),$.jsx(K.Tab,{"aria-controls":"references-panel",disabled:A,id:"references-tab",label:"References",onClick:()=>y("references"),selected:"references"===x,size:2})]}),$.jsxs(K.Box,{as:"form",marginTop:4,onSubmit:B(L),children:[!p&&$.jsx(K.Card,{marginBottom:3,padding:3,radius:2,shadow:1,tone:"critical",children:$.jsx(K.Text,{size:1,children:"This file cannot be found â€“ it may have been deleted."})}),$.jsx("button",{style:{display:"none"},tabIndex:-1,type:"submit"}),$.jsx(K.TabPanel,{"aria-labelledby":"details",hidden:"details"!==x,id:"details-panel",children:$.jsxs(K.Stack,{space:3,children:[$.jsx(la,{control:S,disabled:A,error:null==(n=null==(t=null==_?void 0:_.opt)?void 0:t.media)?void 0:n.tags,label:"Tags",name:"opt.media.tags",onCreateTag:e=>{u(dt.createRequest({assetId:null==v?void 0:v._id,name:e}))},options:b,placeholder:"Select or create...",value:j}),$.jsx(ra,{disabled:A,error:null==_?void 0:_.originalFilename,label:"Filename",name:"originalFilename",ref:D,value:null==v?void 0:v.originalFilename}),$.jsx(ra,{disabled:A,error:null==_?void 0:_.title,label:"Title",name:"title",ref:D,value:null==v?void 0:v.title}),$.jsx(ra,{disabled:A,error:null==_?void 0:_.altText,label:"Alt Text",name:"altText",ref:D,value:null==v?void 0:v.altText}),$.jsx(da,{disabled:A,error:null==_?void 0:_.description,label:"Description",name:"description",ref:D,rows:3,value:null==v?void 0:v.description}),$.jsx(K.Card,{padding:4,children:$.jsxs(K.Stack,{children:[$.jsx("label",{htmlFor:"isLicensed",children:"Photo licensed ?"}),$.jsxs(K.Select,{ref:D,id:"isLicensed",name:"isLicensed",defaultValue:null!=(a=null==v?void 0:v.isLicensed)?a:"no",children:[$.jsx("option",{value:"yes",children:"Yes"}),$.jsx("option",{value:"no",children:"No"})]})]})}),$.jsx(ra,{disabled:A,error:null==_?void 0:_.altText,label:"Renew Date",name:"renewDate",type:"date",ref:D,value:null==v?void 0:v.renewDate})]})}),$.jsx(K.TabPanel,{"aria-labelledby":"references",hidden:"references"!==x,id:"references-panel",children:$.jsx(K.Box,{marginTop:5,children:(null==p?void 0:p.asset)&&$.jsx(zn,{assetId:null==p?void 0:p.asset._id})})})]})]}),$.jsxs(K.Box,{flex:1,padding:4,children:[$.jsxs(K.Box,{style:{aspectRatio:"1"},children:[Sn(v)&&$.jsx(Ln,{asset:v}),_n(v)&&$.jsx(ua,{draggable:!1,showCheckerboard:!(null==(i=null==v?void 0:v.metadata)?void 0:i.isOpaque),src:Tn(v,{height:600,width:600})})]}),v&&$.jsx(K.Box,{marginTop:4,children:$.jsx(Bn,{asset:v,item:p})})]})]}),s]}):null},ma=e=>{const{children:t,dialog:n}=e,a=te.useDispatch(),i=()=>{a(Dt.remove({id:null==n?void 0:n.id}))},s=()=>{(null==n?void 0:n.closeDialogId)&&a(Dt.remove({id:null==n?void 0:n.closeDialogId})),(null==n?void 0:n.confirmCallbackAction)&&a(n.confirmCallbackAction),i()},o=()=>$.jsx(K.Box,{padding:3,children:$.jsxs(K.Flex,{justify:"space-between",children:[$.jsx(K.Button,{fontSize:1,mode:"bleed",onClick:i,text:"Cancel"}),$.jsx(K.Button,{fontSize:1,onClick:s,text:null==n?void 0:n.confirmText,tone:null==n?void 0:n.tone})]})}),l=()=>$.jsxs(K.Flex,{align:"center",children:[$.jsx(K.Box,{paddingX:1,children:$.jsx(W.WarningOutlineIcon,{})}),$.jsx(K.Box,{marginLeft:2,children:null==n?void 0:n.headerTitle})]});return $.jsxs(Dn,{footer:$.jsx(o,{}),header:$.jsx(l,{}),id:"confirm",onClose:i,width:1,children:[$.jsx(K.Box,{paddingX:4,paddingY:4,children:$.jsxs(K.Stack,{space:3,children:[(null==n?void 0:n.title)&&$.jsx(K.Text,{size:1,children:n.title}),(null==n?void 0:n.description)&&$.jsx(K.Text,{muted:!0,size:1,children:$.jsx("em",{children:n.description})})]})}),t]})},ga=e=>{const{children:t,dialog:{id:n}}=e,a=te.useDispatch(),i=Z.useCallback((()=>{a(Dt.clear())}),[]);return $.jsxs(Dn,{header:"Filters",id:n,onClose:i,width:1,children:[$.jsxs(K.Box,{padding:3,children:[$.jsx(fn,{layout:"stack"}),$.jsx(xn,{})]}),t]})},fa=Re.object().shape({name:Re.string().required("Name cannot be empty")}),xa=e=>{const{children:t,dialog:{id:n}}=e,a=te.useDispatch(),i=Rt((e=>e.tags.creating)),s=Rt((e=>e.tags.creatingError)),{formState:{errors:o,isDirty:l,isValid:r},handleSubmit:d,register:c,setError:u}=me.useForm({defaultValues:{name:""},mode:"onChange",resolver:he.yupResolver(fa)}),p=i,h=async e=>{const t=kn(e);a(dt.createRequest({name:t.name}))};Z.useEffect((()=>{s&&u("name",{message:null==s?void 0:s.message})}),[s]);const m=()=>$.jsx(K.Box,{padding:3,children:$.jsx(K.Flex,{justify:"flex-end",children:$.jsx(ca,{disabled:p||!l||!r,isValid:r,onClick:d(h)})})});return $.jsxs(Dn,{footer:$.jsx(m,{}),header:"Create Tag",id:n,onClose:()=>{a(Dt.clear())},width:1,children:[$.jsxs(K.Box,{as:"form",padding:4,onSubmit:d(h),children:[$.jsx("button",{style:{display:"none"},tabIndex:-1,type:"submit"}),$.jsx(ra,{disabled:p,error:null==o?void 0:o.name,label:"Name",name:"name",ref:c})]}),t]})},ya=Re.object().shape({name:Re.string().required("Name cannot be empty")}),va=e=>{const{children:t,dialog:{id:n,tagId:a}}=e,i=$e(),s=te.useDispatch(),o=Rt((e=>rt(e,String(a)))),[l,r]=Z.useState(null==o?void 0:o.tag),d=o?null==o?void 0:o.tag:l,c=e=>{var t;return{name:(null==(t=null==e?void 0:e.name)?void 0:t.current)||""}},{formState:{errors:u,isDirty:p,isValid:h},handleSubmit:m,register:g,reset:f,setError:x}=me.useForm({defaultValues:c(null==o?void 0:o.tag),mode:"onChange",resolver:he.yupResolver(ya)}),y=!o||(null==o?void 0:o.updating),v=async e=>{var t;if(!(null==o?void 0:o.tag))return;const n=kn(e);s(dt.updateRequest({closeDialogId:null==(t=null==o?void 0:o.tag)?void 0:t._id,formData:{name:{_type:"slug",current:n.name}},tag:null==o?void 0:o.tag}))},b=()=>{var e;(null==o?void 0:o.tag)&&s(Dt.showConfirmDeleteTag({closeDialogId:null==(e=null==o?void 0:o.tag)?void 0:e._id,tag:null==o?void 0:o.tag}))},j=e=>{const{result:t,transition:n}=e;t&&"update"===n&&(r(t),f(c(t)))};Z.useEffect((()=>{var e;(null==o?void 0:o.error)&&x("name",{message:null==(e=o.error)?void 0:e.message})}),[null==o?void 0:o.error]),Z.useEffect((()=>{if(!(null==o?void 0:o.tag))return;const e=i.listen(Se.default(w||(w=Y(["*[_id == $id]"]))),{id:null==o?void 0:o.tag._id}).subscribe(j);return()=>{null==e||e.unsubscribe()}}),[]);const I=()=>{var e;return $.jsx(K.Box,{padding:3,children:$.jsxs(K.Flex,{justify:"space-between",children:[$.jsx(K.Button,{disabled:y,fontSize:1,mode:"bleed",onClick:b,text:"Delete",tone:"critical"}),$.jsx(ca,{disabled:y||!p||!h,isValid:h,lastUpdated:null==(e=null==o?void 0:o.tag)?void 0:e._updatedAt,onClick:m(v)})]})})};return d?$.jsxs(Dn,{footer:$.jsx(I,{}),header:"Edit Tag",id:n,onClose:()=>{s(Dt.remove({id:n}))},width:1,children:[$.jsxs(K.Box,{as:"form",padding:4,onSubmit:m(v),children:[!o&&$.jsx(K.Card,{marginBottom:3,padding:3,radius:2,shadow:1,tone:"critical",children:$.jsx(K.Text,{size:1,children:"This tag cannot be found â€“ it may have been deleted."})}),$.jsx("button",{style:{display:"none"},tabIndex:-1,type:"submit"}),$.jsx(ra,{disabled:y,error:null==u?void 0:u.name,label:"Name",name:"name",ref:g})]}),t]}):null},ba=_e.default(K.Flex)(T||(T=Y(["\n  height: ","px;\n"])),Xe),ja=_e.default(K.Flex)(k||(k=Y(["\n  @media (pointer: fine) {\n    visibility: hidden;\n  }\n\n  @media (hover: hover) and (pointer: fine) {\n    ",":hover & {\n      visibility: visible;\n    }\n  }\n"])),ba),Ia=e=>{const{disabled:t,icon:n,onClick:a,tone:i,tooltip:s}=e;return $.jsx(K.Tooltip,{content:$.jsx(K.Container,{padding:2,width:0,children:$.jsx(K.Text,{muted:!0,size:1,children:s})}),disabled:"ontouchstart"in window,placement:"top",children:$.jsx(K.Button,{disabled:t,fontSize:1,icon:n,mode:"bleed",onClick:a,padding:2,tone:i})})},Ca=e=>{var t,n;const{actions:a,tag:i}=e,s=te.useDispatch(),o=Rt(Ct),l=Rt(pt),r=Rt((e=>{var t;return ht(e,null==(t=null==i?void 0:i.tag)?void 0:t._id)}));return $.jsxs(ba,{align:"center",flex:1,justify:"space-between",paddingLeft:3,children:[$.jsx(K.Box,{flex:1,children:$.jsx(K.Text,{size:1,style:{color:(null==i?void 0:i.updating)?le.hues.gray[800].hex:le.hues.gray[500].hex,userSelect:"none"},textOverflow:"ellipsis",children:null==(n=null==(t=null==i?void 0:i.tag)?void 0:t.name)?void 0:n.current})}),$.jsxs(ja,{align:"center",style:{flexShrink:0},children:[(null==a?void 0:a.includes("search"))&&$.jsx(Ia,{disabled:null==i?void 0:i.updating,icon:r?$.jsx(W.CloseIcon,{}):$.jsx(W.SearchIcon,{}),onClick:r?()=>{s(mt.facetsRemove({facetName:"tag"}))}:()=>{var e,t,n;const a=X(X({},Le.tag),{},{value:{label:null==(t=null==(e=null==i?void 0:i.tag)?void 0:e.name)?void 0:t.current,value:null==(n=null==i?void 0:i.tag)?void 0:n._id}});s(l?mt.facetsUpdate({name:"tag",operatorType:"references",value:a.value}):mt.facetsAdd({facet:a}))},tooltip:r?"Remove filter":"Filter by tag"}),(null==a?void 0:a.includes("edit"))&&$.jsx(Ia,{disabled:null==i?void 0:i.updating,icon:$.jsx(W.EditIcon,{}),onClick:()=>{var e;s(it.showTagEdit({tagId:null==(e=null==i?void 0:i.tag)?void 0:e._id}))},tone:"primary",tooltip:"Edit tag"}),(null==a?void 0:a.includes("applyAll"))&&$.jsx(Ia,{disabled:null==i?void 0:i.updating,icon:$.jsx(W.ArrowUpIcon,{}),onClick:()=>{s(Dt.showConfirmAssetsTagAdd({assetsPicked:o,tag:i.tag}))},tone:"primary",tooltip:"Add tag to selected assets"}),(null==a?void 0:a.includes("removeAll"))&&$.jsx(Ia,{disabled:null==i?void 0:i.updating,icon:$.jsx(W.ArrowDownIcon,{}),onClick:()=>{s(Dt.showConfirmAssetsTagRemove({assetsPicked:o,tag:i.tag}))},tone:"critical",tooltip:"Remove tag from selected assets"}),(null==a?void 0:a.includes("delete"))&&$.jsx(Ia,{disabled:null==i?void 0:i.updating,icon:$.jsx(W.TrashIcon,{}),onClick:()=>{s(Dt.showConfirmDeleteTag({tag:i.tag}))},tone:"critical",tooltip:"Delete tag"})]})]})},wa=Z.memo((e=>{let{isScrolling:t,item:n}=e;var a;return"string"==typeof n?$.jsx(K.Flex,{align:"center",justify:"space-between",paddingX:3,style:{height:"".concat(Xe,"px")},children:$.jsx(K.Label,{size:0,children:n})},n):$.jsx(Ca,{actions:t?void 0:n.actions,tag:n},null==(a=n.tag)?void 0:a._id)})),Ta=()=>{const e=Rt(Ct),t=Rt(lt),[n,a]=Z.useState(!1),i=null==e?void 0:e.reduce(((e,t)=>{var n,a,i,s;const o=(null==(s=null==(i=null==(a=null==(n=null==t?void 0:t.asset)?void 0:n.opt)?void 0:a.media)?void 0:i.tags)?void 0:s.map((e=>e._ref)))||[];return e=e.concat(o)}),[]),s=[...new Set(i)],o=s.reduce(((t,n)=>{const a=e.every((e=>{var t,a,i,s;return(null!=(s=null==(i=null==(a=null==(t=e.asset.opt)?void 0:t.media)?void 0:a.tags)?void 0:i.findIndex((e=>e._ref===n)))?s:-1)>=0}));return a?t.appliedToAll.push(n):t.appliedToSome.push(n),t}),{appliedToAll:[],appliedToSome:[]}),l=t.filter((e=>o.appliedToAll.includes(e.tag._id))).map((e=>X(X({},e),{},{actions:["delete","edit","removeAll","search"]}))),r=t.filter((e=>o.appliedToSome.includes(e.tag._id))).map((e=>X(X({},e),{},{actions:["applyAll","delete","edit","removeAll","search"]}))),d=t.filter((e=>!s.includes(e.tag._id))).map((e=>X(X({},e),{},{actions:["applyAll","delete","edit","search"]})));let c=[];return 0===e.length?c=t.map((e=>X(X({},e),{},{actions:["delete","edit","search"]}))):((null==l?void 0:l.length)>0&&(c=[...c,1===e.length?"Used":"Used by all",...l]),(null==r?void 0:r.length)>0&&(c=[...c,"Used by some",...r]),(null==d?void 0:d.length)>0&&(c=[...c,"Unused",...d])),$.jsx(pe.Virtuoso,{className:"media__custom-scrollbar",computeItemKey:e=>{const t=c[e];return"string"==typeof t?t:t.tag._id},isScrolling:a,itemContent:e=>$.jsx(wa,{isScrolling:n,item:c[e]}),style:{flex:1,overflowX:"hidden"},totalCount:c.length})},ka=e=>{var t,n;const{allowCreate:a,light:i,title:s}=e,o=te.useDispatch(),l=Rt((e=>e.tags.creating)),r=Rt((e=>e.tags.fetching));return $.jsx($.Fragment,{children:$.jsxs(K.Flex,{align:"center",justify:"space-between",paddingLeft:3,style:{background:i?null==(t=le.hues.gray)?void 0:t[900].hex:le.black.hex,borderBottom:"1px solid ".concat(null==(n=le.hues.gray)?void 0:n[900].hex),height:"".concat(Xe,"px")},children:[$.jsxs(K.Inline,{space:2,children:[$.jsx(K.Label,{size:0,children:s}),r&&$.jsx(K.Label,{size:0,style:{opacity:.3},children:"Loading..."})]}),a&&$.jsx(K.Box,{marginRight:1,children:$.jsx(K.Button,{disabled:l,fontSize:1,icon:W.ComposeIcon,mode:"bleed",onClick:()=>{o(it.showTagCreate())},style:{background:"transparent",boxShadow:"none"}})})]})})},Sa=()=>{const e=Rt(wt),t=Rt(lt),n=Rt((e=>e.tags.fetching)),a=-1!==Rt((e=>e.tags.fetchCount)),i=!n&&(null==t?void 0:t.length)>0,s=!!(e>0);return $.jsxs(K.Flex,{direction:"column",flex:1,style:{background:le.black.hex,height:"100%"},children:[$.jsx(ka,{allowCreate:!0,light:s,title:s?"Tags (in selection)":"Tags"}),a&&!i&&$.jsx(K.Box,{padding:3,children:$.jsx(K.Text,{size:1,style:{color:le.hues.gray[700].hex},children:$.jsx("em",{children:"No tags"})})}),i&&$.jsx(Ta,{})]})},_a=e=>{const{children:t,dialog:{id:n}}=e,a=te.useDispatch(),i=Z.useCallback((()=>{a(Dt.clear())}),[]);return $.jsxs(Dn,{header:"All Tags",id:n,onClose:i,width:1,children:[$.jsx(K.Box,{style:{height:"100%",minHeight:"420px"},children:$.jsx(Sa,{})}),t]})},Ea=()=>{const e=Rt((e=>e.dialog.items)),t=(e,n)=>{if(0===e.length||n>=e.length)return null;const a=e[n],i=t(e,n+1);return"assetEdit"===a.type?$.jsx(ha,{dialog:a,children:i},n):"confirm"===a.type?$.jsx(ma,{dialog:a,children:i},n):"searchFacets"===a.type?$.jsx(ga,{dialog:a,children:i},n):"tagCreate"===a.type?$.jsx(xa,{dialog:a,children:i},n):"tagEdit"===a.type?$.jsx(va,{dialog:a,children:i},n):"tags"===a.type?$.jsx(_a,{dialog:a,children:i},n):null};return t(e,0)},Ma=Z.createContext(void 0),Ra=e=>{const{children:t,open:n}=e,a={open:n};return $.jsx(Ma.Provider,{value:a,children:t})},Ba=e=>{const{onClose:t}=e,{open:n}=(()=>{const e=Z.useContext(Ma);if(void 0===e)throw new Error("useDropzoneActions must be used within an DropzoneDispatchProvider");return e})(),{onSelect:a}=We(),i=Rt((e=>e.assets.assetTypes)),s=Rt((e=>e.selected.document));return $.jsx(K.Box,{paddingY:2,children:$.jsxs(K.Flex,{align:"center",justify:"space-between",children:[$.jsx(K.Box,{flex:1,marginX:3,children:$.jsxs(K.Inline,{style:{whiteSpace:"nowrap"},children:[$.jsx(K.Text,{textOverflow:"ellipsis",weight:"semibold",children:$.jsx("span",{children:a?"Insert ".concat(i.join(" or ")):"Browse Assets"})}),s&&$.jsx(K.Box,{display:["none","none","block"],children:$.jsxs(K.Text,{children:[$.jsx("span",{style:{margin:"0 0.5em"},children:$.jsx(W.Icon,{symbol:"arrow-right"})}),$.jsx("span",{style:{textTransform:"capitalize"},children:s._type})]})})]})}),$.jsxs(K.Flex,{marginX:2,children:[$.jsx(K.Button,{fontSize:1,icon:W.UploadIcon,mode:"bleed",onClick:n,text:"Upload ".concat(1===i.length?Ee.default(i[0]):"assets"),tone:"primary"}),t&&$.jsx(K.Box,{style:{flexShrink:0},children:$.jsx(K.Button,{disabled:!t,icon:W.CloseIcon,mode:"bleed",onClick:t,radius:2})})]})]})})},Da=ne.createSelector([e=>e.assets.allIds,e=>e.uploads.allIds],((e,t)=>{const n=e.map((e=>({id:e,type:"asset"})));return[...t.map((e=>({id:e,type:"upload"}))),...n]})),za=_e.default(K.Flex)(S||(S=Y(["\n  box-sizing: border-box;\n  height: 100%;\n  overflow: hidden;\n  padding: 2px;\n  position: relative;\n  width: 100%;\n"]))),Fa=_e.default(K.Flex)(_||(_=Y(["\n  border: 1px solid transparent;\n  height: 100%;\n  pointer-events: ",";\n  position: relative;\n  transition: all 300ms;\n  user-select: none;\n  width: 100%;\n\n  border: ",";\n\n  ","\n"])),(e=>e.updating?"none":"auto"),(e=>e.picked?"1px solid ".concat(e.theme.sanity.color.spot.orange," !important"):"1px solid inherit"),(e=>!e.updating&&re.css(E||(E=Y(["\n      @media (hover: hover) and (pointer: fine) {\n        &:hover {\n          border: 1px solid ",";\n        }\n      }\n    "])),le.hues.gray[500].hex))),Aa=_e.default(K.Flex)(M||(M=Y(["\n  cursor: ",";\n  height: ","px;\n  transition: all 300ms;\n\n  @media (hover: hover) and (pointer: fine) {\n    &:hover {\n      background: ",";\n    }\n  }\n"])),(e=>e.selected?"default":"pointer"),Xe,le.hues.gray[950].hex),qa=_e.default(W.WarningFilledIcon)((e=>{let{theme:t}=e;return{color:t.sanity.color.spot.red}}));var Oa=Z.memo((e=>{var t,n;const{id:a,selected:i}=e,s=qe("shift"),o=te.useDispatch(),l=Rt((e=>e.assets.lastPicked)),r=Rt((e=>bt(e,a))),d=null==r?void 0:r.asset,c=null==r?void 0:r.error,u=null==(n=null==(t=null==r?void 0:r.asset)?void 0:t.metadata)?void 0:n.isOpaque,p=null==r?void 0:r.picked,h=null==r?void 0:r.updating,{onSelect:m}=We();if(!d)return null;const g=h?.5:1,f=i||h?.25:1;return $.jsx(za,{children:$.jsxs(Fa,{direction:"column",picked:p,updating:r.updating,children:[$.jsxs(K.Box,{flex:1,style:{cursor:i?"default":"pointer",position:"relative"},children:[$.jsxs("div",{onClick:e=>{e.stopPropagation(),m?m([{kind:"assetDocumentId",value:d._id}]):s.current?o(p?Tt.pick({assetId:d._id,picked:!p}):Tt.pickRange({startId:l||d._id,endId:d._id})):o(Dt.showAssetEdit({assetId:d._id}))},style:{height:"100%",opacity:f},children:[Sn(d)&&$.jsx(On,{extension:d.extension,width:"80px"}),_n(d)&&$.jsx(ua,{draggable:!1,showCheckerboard:!u,src:Tn(d,{height:250,width:250}),style:{draggable:!1,transition:"opacity 1000ms"}})]}),i&&!h&&$.jsx(K.Flex,{align:"center",justify:"center",style:{height:"100%",left:0,opacity:g,position:"absolute",top:0,width:"100%"},children:$.jsx(K.Text,{size:2,children:$.jsx(W.CheckmarkCircleIcon,{})})}),h&&$.jsx(K.Flex,{align:"center",justify:"center",style:{height:"100%",left:0,position:"absolute",top:0,width:"100%"},children:$.jsx(K.Spinner,{})})]}),$.jsxs(Aa,{align:"center",onClick:e=>{e.stopPropagation(),m?o(Dt.showAssetEdit({assetId:d._id})):s.current&&!p?o(Tt.pickRange({startId:l||d._id,endId:d._id})):o(Tt.pick({assetId:d._id,picked:!p}))},paddingX:1,style:{opacity:g},children:[m?$.jsx(W.EditIcon,{style:{flexShrink:0,opacity:.5}}):$.jsx(K.Checkbox,{checked:p,readOnly:!0,style:{flexShrink:0,pointerEvents:"none",transform:"scale(0.8)"}}),$.jsx(K.Box,{marginLeft:2,children:$.jsx(K.Text,{muted:!0,size:0,textOverflow:"ellipsis",children:d.originalFilename})})]}),c&&$.jsx(K.Box,{padding:3,style:{position:"absolute",right:0,top:0},children:$.jsx(K.Tooltip,{content:$.jsx(K.Container,{padding:2,width:0,children:$.jsx(K.Text,{size:1,children:c})}),placement:"left",portal:!0,children:$.jsx(K.Text,{size:1,children:$.jsx(qa,{color:"critical"})})})})]})})}));const La=180,Pa=async e=>{const t=await(e=>new Promise((t=>{const n=window.URL.createObjectURL(e),a=new Image;a.onload=()=>{window.URL.revokeObjectURL(n),t(a)},a.src=n})))(e),n=await(a=t,new Promise((e=>{const t=a.width/a.height,n=document.createElement("canvas");n.width=La,n.height=Math.max(La/t,1);try{const i=n.getContext("2d");null==i||i.drawImage(a,0,0,La,La/t),n.toBlob(e,"image/jpeg")}catch(e){console.warn("Unable to generate preview image:",e)}})));var a;if(!n)throw Error("Unable to generate file Blob");return window.URL.createObjectURL(n)},Ua=4;function Na(e,t){const n=e.indexOf(t);return n>-1&&e.splice(n,1),e}const Va=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ua;const t=[],n=[],a=new se.Subject;return function i(s){return new se.Observable((o=>{if(t.length>=e)return function(e){return n.push(e),a.asObservable().pipe(oe.first((t=>t===e)))}(s).pipe(oe.mergeMap(i)).subscribe(o);const l=s.subscribe(o);return t.push(l),()=>{for(Na(t,l),Na(n,s),l.unsubscribe();n.length>0&&t.length<e;)a.next(n.shift())}}))}},Qa=e=>Array.prototype.map.call(new Uint8Array(e),(e=>"00".concat(e.toString(16)).slice(-2))).join(""),Xa=e=>window.crypto&&window.crypto.subtle&&window.FileReader?(e=>new se.Observable((t=>{const n=new FileReader;return n.onload=()=>{t.next(n.result),t.complete()},n.onerror=e=>{t.error(e)},n.readAsArrayBuffer(e),()=>{n.abort()}})))(e).pipe(oe.mergeMap((e=>window.crypto.subtle.digest("SHA-1",e))),oe.map(Qa)):se.throwError({message:"Unable to generate hash: uploads are only allowed in secure contexts",statusCode:500}),Ha=function(e){const t=Va(arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ua);return function(){return se.from(t(e(...arguments)))}}(((e,t,n,a)=>se.of(null).pipe(oe.mergeMap((()=>((e,t,n)=>e.observable.fetch("*[_type == $documentType && sha1hash == $hash][0]",{documentType:t,hash:n}))(e,"sanity.".concat(t,"Asset"),a))),oe.mergeMap((e=>e?se.throwError({message:"Asset already exists",statusCode:409}):se.of(null))),oe.mergeMap((()=>e.observable.assets.upload(t,n,{extract:["blurhash","exif","location","lqip","palette"],preserveFilename:!0}).pipe(oe.map((e=>"response"===e.type?{asset:e.body.document,id:e.body.document._id,type:"complete"}:e)))))))),Ya=ne.createSlice({name:"uploads",initialState:{allIds:[],byIds:{}},extraReducers:e=>{e.addCase(ft.uploadComplete,((e,t)=>{const{asset:n}=t.payload;e.byIds[n.sha1hash]&&(e.byIds[n.sha1hash].status="complete")}))},reducers:{checkRequest(e,t){},checkComplete(e,t){const{results:n}=t.payload;Object.keys(n).forEach((t=>{const n=e.allIds.indexOf(t);if(n>=0&&e.allIds.splice(n,1),e.byIds[t]){const n=e.byIds[t].objectUrl;n&&window.URL.revokeObjectURL(n),delete e.byIds[t]}}))},previewReady(e,t){const{blobUrl:n,hash:a}=t.payload;e.byIds[a]&&(e.byIds[a].objectUrl=n)},uploadCancel(e,t){const{hash:n}=t.payload,a=e.allIds.indexOf(n);a>=0&&e.allIds.splice(a,1),e.byIds[n]&&delete e.byIds[n]},uploadError(e,t){const{hash:n}=t.payload,a=e.allIds.indexOf(n);a>=0&&e.allIds.splice(a,1),delete e.byIds[n]},uploadRequest(e,t){},uploadProgress(e,t){const{event:n,uploadHash:a}=t.payload;e.byIds[a].percent=n.percent,e.byIds[a].status="uploading"},uploadStart(e,t){const{uploadItem:n}=t.payload;e.allIds.includes(n.hash)||e.allIds.push(n.hash),e.byIds[n.hash]=n}}}),Ga=ne.createSelector([e=>e.uploads.byIds,(e,t)=>t],((e,t)=>e[t]));ne.createSelector([e=>e.uploads.byIds,e=>e.uploads.allIds],((e,t)=>t.map((t=>e[t]))));const Wa=Ya.actions;var $a=Ya.reducer;const Ka=_e.default(K.Flex)(B||(B=Y(["\n  box-sizing: border-box;\n  height: 100%;\n  overflow: hidden;\n  padding: 2px;\n  position: relative;\n  width: 100%;\n"]))),Za=e=>{const{id:t}=e,n=te.useDispatch(),a=Rt((e=>Ga(e,t)));if(!a)return null;const i=De.default(a.size,{base:10,round:0}),s=Math.round(a.percent||0),o="complete"===a.status,l="uploading"===a.status,r="queued"===a.status;let d;o&&(d="Verifying"),l&&(d="".concat(s,"%")),r&&(d="Queued");return $.jsx(Ka,{children:$.jsxs(K.Flex,{direction:"column",flex:1,style:{background:le.hues.gray[950].hex,border:"1px solid transparent",height:"100%",position:"relative"},children:[$.jsx("div",{style:{background:le.hues.gray[600].hex,bottom:0,height:"1px",left:0,position:"absolute",width:"100%",transform:"scaleX(".concat(.01*s,")"),transformOrigin:"bottom left",transition:"all 1000ms ease-out"}}),$.jsxs(K.Box,{flex:1,style:{position:"relative"},children:["image"===a.assetType&&(null==a?void 0:a.objectUrl)&&$.jsx(ua,{draggable:!1,src:a.objectUrl,style:{opacity:.4}}),"file"===a.assetType&&$.jsx("div",{style:{height:"100%",opacity:.1},children:$.jsx(On,{width:"80px"})}),!o&&100!==s&&$.jsx(K.Flex,{align:"center",direction:"column",justify:"center",style:{height:"100%",left:0,position:"absolute",top:0,width:"100%"},children:$.jsx(K.Tooltip,{content:$.jsx(K.Box,{padding:2,children:$.jsx(K.Text,{muted:!0,size:1,children:"Cancel"})}),disabled:"ontouchstart"in window,placement:"top",children:$.jsx(K.Button,{fontSize:4,icon:W.CloseIcon,mode:"bleed",onClick:()=>{n(Wa.uploadCancel({hash:a.hash}))},padding:2,style:{background:"none",boxShadow:"none"},tone:"critical"})})})]}),$.jsxs(K.Flex,{align:"center",justify:"space-between",paddingX:2,style:{height:"".concat(Xe,"px")},children:[$.jsx(K.Box,{flex:1,marginRight:1,children:$.jsxs(K.Text,{size:0,textOverflow:"ellipsis",children:[a.name," (",i,")"]})}),$.jsx(K.Text,{size:0,style:{flexShrink:0},weight:"semibold",children:d})]})]})})},Ja=Z.memo((e=>{let{item:t,selected:n}=e;return"asset"===(null==t?void 0:t.type)?$.jsx(Oa,{id:t.id,selected:n}):"upload"===(null==t?void 0:t.type)?$.jsx(Za,{id:t.id}):null})),ei=_e.default.div(D||(D=Y(["\n  height: ","px;\n  width: ","px;\n"])),220,240),ti=_e.default.div(z||(z=Y(["\n  display: grid;\n  grid-template-columns: repeat(auto-fill, ","px);\n  justify-content: center;\n  margin: 0 auto;\n"])),240),ni=e=>{const{items:t,onLoadMore:n}=e,a=Rt((e=>e.selected.assets)),i=a&&a.map((e=>e._id))||[],s=null==t?void 0:t.length;return 0===s?null:$.jsx(pe.VirtuosoGrid,{className:"media__custom-scrollbar",computeItemKey:e=>{const n=t[e];return null==n?void 0:n.id},components:{Item:ei,List:ti},endReached:n,itemContent:e=>{const n=t[e],a=i.includes(null==n?void 0:n.id);return $.jsx(Ja,{item:n,selected:a})},overscan:48,style:{overflowX:"hidden"},totalCount:s})},ai=e=>{const{field:t,title:n}=e,a=te.useDispatch(),i=Rt((e=>e.assets.order)),s=i.field===t;return $.jsx(K.Label,{muted:!t,size:0,children:$.jsxs(K.Box,{onClick:t?()=>{if(t&&n)if(s){const e="asc"===i.direction?"desc":"asc";a(Tt.orderSet({order:{field:t,direction:e}}))}else a(Tt.orderSet({order:{field:t,direction:"asc"}}))}:void 0,style:{cursor:t?"pointer":"default",display:"inline",whiteSpace:"nowrap"},children:[$.jsx("span",{style:{marginRight:"0.4em"},children:n}),s&&"asc"===(null==i?void 0:i.direction)&&$.jsx(W.ChevronUpIcon,{}),s&&"desc"===(null==i?void 0:i.direction)&&$.jsx(W.ChevronDownIcon,{})]})})};var ii;const si=_e.default(K.Flex)(F||(F=Y(["\n  cursor: pointer;\n\n  @media (hover: hover) and (pointer: fine) {\n    &:hover {\n      background: ",";\n    }\n  }\n"])),null==(ii=le.hues.gray)?void 0:ii[900].hex),oi=()=>{var e;const t=te.useDispatch(),n=Rt((e=>e.assets.fetching)),a=Rt(It),i=Rt(wt),s=K.useMediaIndex(),{onSelect:o}=We(),l=i===a;return $.jsxs(K.Grid,{style:{alignItems:"center",background:le.black.hex,borderBottom:"1px solid ".concat(null==(e=le.hues.gray)?void 0:e[900].hex),gridColumnGap:s<3?0:"16px",gridTemplateColumns:Qe,height:s<3?0:"".concat(Xe,"px"),letterSpacing:"0.025em",position:"sticky",textTransform:"uppercase",top:0,visibility:s<3?"hidden":"visible",width:"100%",zIndex:1},children:[o?$.jsx(ai,{}):$.jsx(si,{align:"center",justify:"center",onClick:e=>{e.stopPropagation(),t(l?Tt.pickClear():Tt.pickAll())},style:{height:"100%",position:"relative"},children:$.jsx(K.Checkbox,{checked:!n&&l,readOnly:!0,style:{pointerEvents:"none",transform:"scale(0.8)"}})}),$.jsx(ai,{}),$.jsx(ai,{field:"originalFilename",title:"Filename"}),$.jsx(ai,{title:"Resolution"}),$.jsx(ai,{field:"mimeType",title:"MIME type"}),$.jsx(ai,{field:"size",title:"Size"}),$.jsx(ai,{field:"_updatedAt",title:"Last updated"}),$.jsx(ai,{})]})};var li;const ri=_e.default(K.Grid)(A||(A=Y(["\n  align-items: center;\n  cursor: ",";\n  height: 100%;\n  pointer-events: ",";\n  user-select: none;\n  white-space: nowrap;\n\n  ","\n"])),(e=>e.selected?"default":"pointer"),(e=>e.updating?"none":"auto"),(e=>{var t;return!e.updating&&re.css(q||(q=Y(["\n      @media (hover: hover) and (pointer: fine) {\n        &:hover {\n          background: ",";\n        }\n      }\n    "])),null==(t=le.hues.gray)?void 0:t[950].hex)})),di=_e.default(K.Flex)(O||(O=Y(["\n  cursor: pointer;\n\n  @media (hover: hover) and (pointer: fine) {\n    &:hover {\n      background: ",";\n    }\n  }\n"])),null==(li=le.hues.gray)?void 0:li[900].hex),ci=_e.default(W.WarningFilledIcon)((e=>{let{theme:t}=e;return{color:t.sanity.color.spot.red}}));var ui=Z.memo((e=>{var t,n;const{id:a,selected:i}=e,s=qe("shift"),o=te.useDispatch(),l=Rt((e=>e.assets.lastPicked)),r=Rt((e=>bt(e,a))),d=K.useMediaIndex(),c=null==r?void 0:r.asset,u=null==r?void 0:r.error,p=null==(n=null==(t=null==r?void 0:r.asset)?void 0:t.metadata)?void 0:n.isOpaque,h=null==r?void 0:r.picked,m=null==r?void 0:r.updating,{onSelect:g}=We();if(!c)return null;const f=m?.5:1,x=i||m?.1:1;return $.jsxs(ri,{onClick:i?void 0:e=>{e.stopPropagation(),g?g([{kind:"assetDocumentId",value:c._id}]):s.current?o(h?Tt.pick({assetId:c._id,picked:!h}):Tt.pickRange({startId:l||c._id,endId:c._id})):o(Dt.showAssetEdit({assetId:c._id}))},selected:i,style:{gridColumnGap:d<3?0:"16px",gridRowGap:0,gridTemplateColumns:d<3?Ve:Qe,gridTemplateRows:d<3?"auto":"1fr"},updating:r.updating,children:[$.jsx(di,{onClick:e=>{e.stopPropagation(),g?o(Dt.showAssetEdit({assetId:c._id})):s.current&&!h?o(Tt.pickRange({startId:l||c._id,endId:c._id})):o(Tt.pick({assetId:c._id,picked:!h}))},style:{alignItems:"center",gridColumn:1,gridRowStart:1,gridRowEnd:"span 5",height:"100%",justifyContent:"center",opacity:f,position:"relative"},children:g?$.jsx(W.EditIcon,{style:{flexShrink:0,opacity:.5}}):$.jsx(K.Checkbox,{checked:h,readOnly:!0,style:{pointerEvents:"none",transform:"scale(0.8)"}})}),$.jsx(K.Box,{style:{gridColumn:2,gridRowStart:1,gridRowEnd:"span 5",height:"90px",width:"100px"},children:$.jsxs(K.Flex,{align:"center",justify:"center",style:{height:"100%",position:"relative"},children:[$.jsxs(K.Box,{style:{height:"100%",opacity:x,position:"relative"},children:[Sn(c)&&$.jsx(On,{extension:c.extension,width:"40px"}),_n(c)&&$.jsx(ua,{draggable:!1,showCheckerboard:!p,src:Tn(c,{height:100,width:100})})]}),m&&$.jsx(K.Flex,{align:"center",justify:"center",style:{height:"100%",left:0,position:"absolute",top:0,width:"100%"},children:$.jsx(K.Spinner,{})}),i&&!m&&$.jsx(K.Flex,{align:"center",justify:"center",style:{height:"100%",left:0,position:"absolute",top:0,width:"100%"},children:$.jsx(K.Text,{size:2,children:$.jsx(W.CheckmarkCircleIcon,{})})})]})}),$.jsx(K.Box,{marginLeft:d<3?3:0,style:{gridColumn:3,gridRow:d<3?2:"auto",opacity:f},children:$.jsx(K.Text,{muted:!0,size:1,style:{lineHeight:"2em"},textOverflow:"ellipsis",children:c.originalFilename})}),$.jsx(K.Box,{marginLeft:d<3?3:0,style:{gridColumn:d<3?3:4,gridRow:d<3?3:"auto",opacity:f},children:$.jsx(K.Text,{muted:!0,size:1,style:{lineHeight:"2em"},textOverflow:"ellipsis",children:_n(c)&&En(c)})}),$.jsx(K.Box,{style:{display:d<3?"none":"block",gridColumn:5,gridRow:"auto",opacity:f},children:$.jsx(K.Text,{muted:!0,size:1,style:{lineHeight:"2em"},textOverflow:"ellipsis",children:c.mimeType})}),$.jsx(K.Box,{style:{display:d<3?"none":"block",gridColumn:6,gridRow:"auto",opacity:f},children:$.jsx(K.Text,{muted:!0,size:1,style:{lineHeight:"2em"},textOverflow:"ellipsis",children:De.default(c.size,{base:10,round:0})})}),$.jsx(K.Box,{marginLeft:d<3?3:0,style:{gridColumn:d<3?3:7,gridRow:d<3?4:"auto",opacity:f},children:$.jsx(K.Text,{muted:!0,size:1,style:{lineHeight:"2em"},textOverflow:"ellipsis",children:Ae.default(new Date(c._updatedAt),new Date)})}),$.jsx(K.Flex,{align:"center",justify:"center",style:{gridColumn:d<3?4:8,gridRowStart:"1",gridRowEnd:d<3?"span 5":"auto",opacity:f},children:u&&$.jsx(K.Box,{padding:2,children:$.jsx(K.Tooltip,{content:$.jsx(K.Container,{padding:2,width:0,children:$.jsx(K.Text,{size:1,children:u})}),placement:"left",portal:!0,children:$.jsx(K.Text,{size:1,children:$.jsx(ci,{color:"critical"})})})})})]})}));const pi=e=>{const{id:t}=e,n=te.useDispatch(),a=Rt((e=>Ga(e,t))),i=K.useMediaIndex();if(!a)return null;const s=De.default(a.size,{base:10,round:0}),o=Math.round(a.percent||0),l="complete"===a.status,r="uploading"===a.status,d="queued"===a.status;let c;l&&(c="Verifying"),r&&(c="".concat(o,"%")),d&&(c="Queued");return $.jsxs(K.Grid,{style:{alignItems:"center",background:le.hues.gray[950].hex,gridColumnGap:i<3?0:"16px",gridRowGap:0,gridTemplateColumns:i<3?Ve:Qe,gridTemplateRows:i<3?"auto":"1fr",height:"100%",position:"relative"},children:[$.jsx("div",{style:{background:le.hues.gray[600].hex,bottom:0,height:"1px",left:0,position:"absolute",width:"100%",transform:"scaleX(".concat(.01*o,")"),transformOrigin:"bottom left",transition:"all 1000ms ease-out"}}),$.jsx(K.Box,{style:{gridColumn:2,gridRowStart:i<3?1:"auto",gridRowEnd:i<3?"span 4":"auto",height:"90px",width:"100px"},children:$.jsxs(K.Box,{style:{height:"100%",position:"relative"},children:["image"===a.assetType&&(null==a?void 0:a.objectUrl)&&$.jsx(ua,{draggable:!1,src:a.objectUrl,style:{opacity:.25}}),"file"===a.assetType&&$.jsx("div",{style:{height:"100%",opacity:.1},children:$.jsx(On,{width:"40px"})}),!l&&100!==o&&$.jsx(K.Flex,{align:"center",justify:"center",style:{position:"absolute",height:"100%",left:0,top:0,width:"100%"},children:$.jsx(K.Tooltip,{content:$.jsx(K.Box,{padding:2,children:$.jsx(K.Text,{muted:!0,size:1,children:"Cancel"})}),disabled:"ontouchstart"in window,placement:"top",children:$.jsx(K.Button,{fontSize:3,icon:W.CloseIcon,mode:"bleed",onClick:()=>{n(Wa.uploadCancel({hash:a.hash}))},padding:2,style:{background:"none",boxShadow:"none"},tone:"critical"})})})]})}),$.jsx(K.Box,{style:{gridColumn:i<3?3:"3/8",gridRow:i<3?"2/4":"auto",marginLeft:i<3?3:0},children:$.jsxs(K.Stack,{space:3,children:[$.jsxs(K.Text,{muted:!0,size:1,textOverflow:"ellipsis",children:[a.name," (",s,")"]}),$.jsx(K.Text,{size:1,textOverflow:"ellipsis",weight:"semibold",children:c})]})})]})},hi=Z.memo((e=>{let{item:t,selected:n}=e;return"asset"===(null==t?void 0:t.type)?$.jsx(K.Box,{style:{height:"100px"},children:$.jsx(ui,{id:t.id,selected:n})}):"upload"===(null==t?void 0:t.type)?$.jsx(K.Box,{style:{height:"100px"},children:$.jsx(pi,{id:t.id})}):null})),mi=e=>{const{items:t,onLoadMore:n}=e,a=Rt((e=>e.selected.assets)),i=a&&a.map((e=>e._id))||[],s=null==t?void 0:t.length;return 0===s?null:$.jsx(pe.GroupedVirtuoso,{className:"media__custom-scrollbar",computeItemKey:e=>{const n=t[e];return(null==n?void 0:n.id)||e},endReached:n,groupCounts:Array(1).fill(s),groupContent:()=>$.jsx(oi,{}),itemContent:e=>{const n=t[e],a=i.includes(null==n?void 0:n.id);return $.jsx(hi,{item:n,selected:a})},style:{overflowX:"hidden"}})},gi=()=>{const e=te.useDispatch(),t=Rt((e=>e.assets.fetchCount)),n=Rt((e=>e.assets.fetching)),a=Rt((e=>e.tags.panelVisible)),i=Rt((e=>e.assets.view)),s=Rt(Da),o=(()=>{var e,t;const n=null==(t=null==(e=K.studioTheme)?void 0:e.container)?void 0:t.map((e=>window.matchMedia("(max-width: ".concat(e,"px)")))),a=()=>n.findIndex((e=>e.matches)),[i,s]=Z.useState(a());return Z.useEffect((()=>{const e=()=>{s(a)};return n.forEach((t=>{try{t.addEventListener("change",e)}catch(n){try{t.addListener(e)}catch(e){}}})),()=>{try{n.forEach((t=>t.removeEventListener("change",e)))}catch(t){try{n.forEach((t=>t.removeListener(e)))}catch(e){}}}}),[]),i})(),l=t>=0,r=s.length>0,d=()=>{n||e(Tt.loadNextPage())};Z.useEffect((()=>{o<=1&&a&&e(dt.panelVisibleSet({panelVisible:!1}))}),[o]);const c=!r&&l&&!n;return $.jsx(K.Box,{flex:1,style:{width:"100%"},children:c?$.jsx(K.Box,{padding:4,children:$.jsx(K.Text,{size:1,weight:"semibold",children:"No results for the current query"})}):$.jsxs($.Fragment,{children:["grid"===i&&$.jsx(ni,{items:s,onLoadMore:d}),"table"===i&&$.jsx(mi,{items:s,onLoadMore:d})]})})},fi=()=>{const e=Rt((e=>e.notifications.items)),t=K.useToast();return Z.useEffect((()=>{if(e.length>0){const n=e[e.length-1];t.push({closable:!0,status:n.status,title:n.title})}}),[e.length]),null},xi=()=>{var e,t;const n=te.useDispatch(),a=Rt(Ct);return 0===a.length?null:$.jsx(K.Flex,{align:"center",justify:"flex-start",style:{background:null==(e=le.hues.gray)?void 0:e[900].hex,borderBottom:"1px solid ".concat(null==(t=le.hues.gray)?void 0:t[900].hex),height:"".concat(Xe,"px"),position:"relative",width:"100%"},children:$.jsxs(K.Flex,{align:"center",paddingX:3,children:[$.jsx(K.Box,{paddingRight:2,children:$.jsxs(K.Label,{size:0,style:{color:"inherit"},children:[a.length," ",Ee.default("asset",a.length)," selected"]})}),$.jsx(K.Button,{mode:"bleed",onClick:()=>{n(Tt.pickClear())},padding:2,style:{background:"none",boxShadow:"none"},tone:"default",children:$.jsx(K.Label,{size:0,children:"Deselect"})}),$.jsx(K.Button,{mode:"bleed",onClick:()=>{n(Dt.showConfirmDeleteAssets({assets:a}))},padding:2,style:{background:"none",boxShadow:"none"},tone:"critical",children:$.jsx(K.Label,{size:0,children:"Delete"})})]})})};var yi=ne.createSlice({name:"selected",initialState:{assets:[],document:void 0,documentAssetIds:[]},reducers:{}}).reducer;const vi=ne.createSlice({name:"notifications",initialState:{items:[]},reducers:{add(e,t){const{asset:n,status:a,title:i}=t.payload;e.items.push({asset:n,status:a,title:i})}}}),bi=vi.actions;var ji=vi.reducer;const Ii=ie.combineEpics(((e,t,n)=>{let{client:a}=n;return e.pipe(oe.filter(Tt.deleteRequest.match),oe.mergeMap((e=>{const{assets:t}=e.payload,n=t.map((e=>e._id));return se.of(t).pipe(oe.mergeMap((()=>a.observable.delete({query:Se.default(p||(p=Y(["*[_id in ","]"])),JSON.stringify(n))}))),oe.mergeMap((()=>se.of(Tt.deleteComplete({assetIds:n})))),oe.catchError((e=>se.of(Tt.deleteError({assetIds:n,error:e})))))})))}),((e,t,n)=>{let{client:a}=n;return e.pipe(oe.filter(Tt.fetchRequest.match),oe.withLatestFrom(t),oe.switchMap((e=>{let[t,n]=e;var i,s;const o=null==(i=t.payload)?void 0:i.params,l=null==(s=t.payload)?void 0:s.query;return se.of(t).pipe(Je(n.debug.badConnection),oe.mergeMap((()=>a.observable.fetch(l,o))),oe.mergeMap((e=>{const{items:t}=e;return se.of(Tt.fetchComplete({assets:t}))})),oe.catchError((e=>se.of(Tt.fetchError({message:(null==e?void 0:e.message)||"Internal error",statusCode:(null==e?void 0:e.statusCode)||500})))))})))}),((e,t)=>e.pipe(oe.filter(Tt.deleteComplete.match),oe.withLatestFrom(t),oe.switchMap((e=>{let[t,n]=e;if(0===n.assets.allIds.length){const e=Math.floor(n.assets.allIds.length/n.assets.pageSize);return se.of(Tt.loadPageIndex({pageIndex:e}))}return se.empty()})))),((e,t)=>e.pipe(oe.filter(Tt.loadNextPage.match),oe.withLatestFrom(t),oe.switchMap((e=>{let[t,n]=e;return se.of(Tt.loadPageIndex({pageIndex:n.assets.pageIndex+1}))})))),((e,t)=>e.pipe(oe.filter(Tt.loadPageIndex.match),oe.withLatestFrom(t),oe.switchMap((e=>{let[t,n]=e;var a,i,s,o,l,r;const d=n.assets.pageSize,c=t.payload.pageIndex*d,u=c+d,p=null==(a=null==n?void 0:n.selected.document)?void 0:a._id,g=null==(i=null==n?void 0:n.selected)?void 0:i.documentAssetIds,f=et({assetTypes:n.assets.assetTypes,searchFacets:n.search.facets,searchQuery:n.search.query}),x=X(X({},p?{documentId:p}:{}),{},{documentAssetIds:g});return se.of(Tt.fetchRequest({params:x,queryFilter:f,selector:Se.default(h||(h=Y(["[","...","]"])),c,u),sort:Se.default(m||(m=Y(["order("," ",")"])),null==(o=null==(s=n.assets)?void 0:s.order)?void 0:o.field,null==(r=null==(l=n.assets)?void 0:l.order)?void 0:r.direction)}))})))),(e=>e.pipe(oe.filter(Tt.listenerCreateQueue.match),oe.bufferTime(2e3),oe.filter((e=>e.length>0)),oe.mergeMap((e=>{const t=null==e?void 0:e.map((e=>e.payload.asset));return se.of(Tt.listenerCreateQueueComplete({assets:t}))})))),(e=>e.pipe(oe.filter(Tt.listenerDeleteQueue.match),oe.bufferTime(2e3),oe.filter((e=>e.length>0)),oe.mergeMap((e=>{const t=null==e?void 0:e.map((e=>e.payload.assetId));return se.of(Tt.listenerDeleteQueueComplete({assetIds:t}))})))),(e=>e.pipe(oe.filter(Tt.listenerUpdateQueue.match),oe.bufferTime(2e3),oe.filter((e=>e.length>0)),oe.mergeMap((e=>{const t=null==e?void 0:e.map((e=>e.payload.asset));return se.of(Tt.listenerUpdateQueueComplete({assets:t}))})))),(e=>e.pipe(oe.filter(Tt.orderSet.match),oe.mergeMap((()=>se.of(Tt.clear(),Tt.loadPageIndex({pageIndex:0})))))),(e=>e.pipe(ie.ofType(mt.facetsAdd.type,mt.facetsClear.type,mt.facetsRemove.type,mt.facetsUpdate.type,mt.querySet.type),oe.debounceTime(400),oe.mergeMap((()=>se.of(Tt.clear(),Tt.loadPageIndex({pageIndex:0})))))),(e=>e.pipe(ie.ofType(Tt.insertUploads.type,Tt.listenerUpdateQueueComplete.type,Tt.updateComplete.type),oe.mergeMap((()=>se.of(Tt.sort()))))),((e,t,n)=>{let{client:a}=n;return e.pipe(oe.filter(at.tagsAddRequest.match),oe.withLatestFrom(t),oe.mergeMap((e=>{let[t,n]=e;const{assets:i,tag:s}=t.payload;return se.of(t).pipe(Je(n.debug.badConnection),oe.mergeMap((()=>{const e=Ct(n),t=null==e?void 0:e.filter((e=>t=>{var n,a,i,s,o;return(null!=(o=null==(s=null==(i=null==(a=null==(n=null==t?void 0:t.asset)?void 0:n.opt)?void 0:a.media)?void 0:i.tags)?void 0:s.findIndex((t=>t._ref===(null==e?void 0:e._id))))?o:-1)<0})(s)),i=t.reduce(((e,t)=>{var n;return e.patch(null==(n=null==t?void 0:t.asset)?void 0:n._id,(e=>{let{tag:t}=e;return e=>e.setIfMissing({opt:{}}).setIfMissing({"opt.media":{}}).setIfMissing({"opt.media.tags":[]}).append("opt.media.tags",[{_key:ae.nanoid(),_ref:null==t?void 0:t._id,_type:"reference",_weak:!0}])})({tag:s}))}),a.transaction());return se.from(i.commit())})),oe.mergeMap((()=>se.of(at.tagsAddComplete({assets:i,tag:s})))),oe.catchError((e=>se.of(at.tagsAddError({assets:i,error:{message:(null==e?void 0:e.message)||"Internal error",statusCode:(null==e?void 0:e.statusCode)||500},tag:s})))))})))}),((e,t,n)=>{let{client:a}=n;return e.pipe(oe.filter(at.tagsRemoveRequest.match),oe.withLatestFrom(t),oe.mergeMap((e=>{let[t,n]=e;const{assets:i,tag:s}=t.payload;return se.of(t).pipe(Je(n.debug.badConnection),oe.mergeMap((()=>{const e=Ct(n).reduce(((e,t)=>{var n;return e.patch(null==(n=null==t?void 0:t.asset)?void 0:n._id,(e=>{let{asset:t,tag:n}=e;return e=>{var a;return e.ifRevisionId(null==(a=null==t?void 0:t.asset)?void 0:a._rev).unset(['opt.media.tags[_ref == "'.concat(n._id,'"]')])}})({asset:t,tag:s}))}),a.transaction());return se.from(e.commit())})),oe.mergeMap((()=>se.of(at.tagsRemoveComplete({assets:i,tag:s})))),oe.catchError((e=>se.of(at.tagsRemoveError({assets:i,error:{message:(null==e?void 0:e.message)||"Internal error",statusCode:(null==e?void 0:e.statusCode)||500},tag:s})))))})))}),(e=>e.pipe(ie.ofType(Tt.orderSet.type,Tt.viewSet.type,mt.facetsAdd.type,mt.facetsClear.type,mt.facetsRemove.type,mt.facetsUpdate.type,mt.querySet.type),oe.mergeMap((()=>se.of(Tt.pickClear()))))),((e,t,n)=>{let{client:a}=n;return e.pipe(oe.filter(Tt.updateRequest.match),oe.withLatestFrom(t),oe.mergeMap((e=>{let[t,n]=e;const{asset:i,closeDialogId:s,formData:o}=t.payload;return se.of(t).pipe(Je(n.debug.badConnection),oe.mergeMap((()=>se.from(a.patch(i._id).setIfMissing({opt:{}}).setIfMissing({"opt.media":{}}).set(o).commit()))),oe.mergeMap((e=>se.of(Tt.updateComplete({asset:e,closeDialogId:s})))),oe.catchError((e=>se.of(Tt.updateError({asset:i,error:{message:(null==e?void 0:e.message)||"Internal error",statusCode:(null==e?void 0:e.statusCode)||500}})))))})))}),(e=>e.pipe(ie.ofType(Tt.deleteComplete.type,Tt.updateComplete.type,dt.deleteComplete.type,dt.updateComplete.type),oe.filter((e=>{var t;return!!(null==(t=null==e?void 0:e.payload)?void 0:t.closeDialogId)})),oe.mergeMap((e=>{var t;const n=null==(t=null==e?void 0:e.payload)?void 0:t.closeDialogId;return n?se.of(Bt.actions.remove({id:n})):se.empty()})))),(e=>e.pipe(oe.filter(dt.createComplete.match),oe.mergeMap((e=>{const{assetId:t,tag:n}=null==e?void 0:e.payload;return t?se.of(Bt.actions.inlineTagCreate({tag:n,assetId:t})):n._id?se.of(Bt.actions.remove({id:"tagCreate"})):se.empty()})))),(e=>e.pipe(oe.filter(dt.listenerDeleteQueueComplete.match),oe.mergeMap((e=>{const{tagIds:t}=null==e?void 0:e.payload;return se.of(Bt.actions.inlineTagRemove({tagIds:t}))})))),(e=>e.pipe(oe.filter(Tt.deleteError.match),oe.mergeMap((e=>{const{assetIds:t}=e.payload,n=t.length;return se.of(vi.actions.add({status:"error",title:"Unable to delete ".concat(n," ").concat(Ee.default("asset",n),". Please review any asset errors and try again.")}))})))),(e=>e.pipe(oe.filter(Tt.deleteComplete.match),oe.mergeMap((e=>{const{assetIds:t}=e.payload,n=t.length;return se.of(vi.actions.add({status:"info",title:"".concat(n," ").concat(Ee.default("asset",n)," deleted")}))})))),(e=>e.pipe(oe.filter(at.tagsAddComplete.match),oe.mergeMap((e=>{var t,n;const a=null==(n=null==(t=null==e?void 0:e.payload)?void 0:t.assets)?void 0:n.length;return se.of(vi.actions.add({status:"info",title:"Tag added to ".concat(a," ").concat(Ee.default("asset",a))}))})))),(e=>e.pipe(oe.filter(at.tagsRemoveComplete.match),oe.mergeMap((e=>{var t,n;const a=null==(n=null==(t=null==e?void 0:e.payload)?void 0:t.assets)?void 0:n.length;return se.of(vi.actions.add({status:"info",title:"Tag removed from ".concat(a," ").concat(Ee.default("asset",a))}))})))),(e=>e.pipe(oe.filter(Tt.updateComplete.match),oe.bufferTime(2e3),oe.filter((e=>e.length>0)),oe.mergeMap((e=>{const t=e.length;return se.of(vi.actions.add({status:"info",title:"".concat(t," ").concat(Ee.default("asset",t)," updated")}))})))),(e=>e.pipe(ie.ofType(Tt.fetchError.type,Tt.updateError.type,dt.createError.type,dt.deleteError.type,dt.fetchError.type,dt.updateError.type,Wa.uploadError.type),oe.mergeMap((e=>{var t;const n=null==(t=e.payload)?void 0:t.error;return se.of(vi.actions.add({status:"error",title:"An error occured: ".concat(n.message)}))})))),(e=>e.pipe(oe.filter(dt.createComplete.match),oe.mergeMap((()=>se.of(vi.actions.add({status:"info",title:"Tag created"})))))),(e=>e.pipe(oe.filter(dt.deleteComplete.match),oe.mergeMap((()=>se.of(vi.actions.add({status:"info",title:"Tag deleted"})))))),(e=>e.pipe(oe.filter(dt.updateComplete.match),oe.mergeMap((()=>se.of(vi.actions.add({status:"info",title:"Tag updated"})))))),((e,t)=>e.pipe(oe.filter(dt.updateComplete.match),oe.withLatestFrom(t),oe.mergeMap((e=>{let[t,n]=e;var a,i,s,o,l;const{tag:r}=t.payload,d=null==(a=n.search.facets)?void 0:a.find((e=>"tag"===e.name)),c=n.tags.byIds[r._id];return"searchable"===(null==d?void 0:d.type)&&(null==(i=d.value)?void 0:i.value)===r._id?se.of(ut.actions.facetsUpdate({name:"tag",value:{label:null==(o=null==(s=null==c?void 0:c.tag)?void 0:s.name)?void 0:o.current,value:null==(l=null==c?void 0:c.tag)?void 0:l._id}})):se.empty()})))),((e,t,n)=>{let{client:a}=n;return e.pipe(oe.filter(st.actions.createRequest.match),oe.withLatestFrom(t),oe.mergeMap((e=>{let[t,n]=e;const{assetId:i,name:s}=t.payload;return se.of(t).pipe(Je(n.debug.badConnection),tt(a,s),oe.mergeMap((()=>a.observable.create({_type:He,name:{_type:"slug",current:s}}))),oe.mergeMap((e=>se.of(st.actions.createComplete({assetId:i,tag:e})))),oe.catchError((e=>se.of(st.actions.createError({error:{message:(null==e?void 0:e.message)||"Internal error",statusCode:(null==e?void 0:e.statusCode)||500},name:s})))))})))}),((e,t,n)=>{let{client:a}=n;return e.pipe(oe.filter(st.actions.deleteRequest.match),oe.withLatestFrom(t),oe.mergeMap((e=>{let[t,n]=e;const{tag:i}=t.payload;return se.of(t).pipe(Je(n.debug.badConnection),oe.mergeMap((()=>a.observable.fetch(Se.default(d||(d=Y(['*[\n              _type in ["sanity.fileAsset", "sanity.imageAsset"]\n              && references(*[_type == "media.tag" && name.current == $tagName]._id)\n            ] {\n              _id,\n              _rev,\n              opt\n            }']))),{tagName:i.name.current}))),oe.mergeMap((e=>{const t=e.map((e=>({id:e._id,patch:{ifRevisionID:e._rev,unset:['opt.media.tags[_ref == "'.concat(i._id,'"]')]}}))).reduce(((e,t)=>e.patch(t.id,t.patch)),a.transaction());return t.delete(i._id),se.from(t.commit())})),oe.mergeMap((()=>se.of(st.actions.deleteComplete({tagId:i._id})))),oe.catchError((e=>se.of(st.actions.deleteError({error:{message:(null==e?void 0:e.message)||"Internal error",statusCode:(null==e?void 0:e.statusCode)||500},tag:i})))))})))}),((e,t,n)=>{let{client:a}=n;return e.pipe(oe.filter(st.actions.fetchRequest.match),oe.withLatestFrom(t),oe.switchMap((e=>{let[t,n]=e;const{query:i}=t.payload;return se.of(t).pipe(Je(n.debug.badConnection),oe.mergeMap((()=>a.observable.fetch(i))),oe.mergeMap((e=>{const{items:t}=e;return se.of(st.actions.fetchComplete({tags:t}))})),oe.catchError((e=>se.of(st.actions.fetchError({error:{message:(null==e?void 0:e.message)||"Internal error",statusCode:(null==e?void 0:e.statusCode)||500}})))))})))}),(e=>e.pipe(oe.filter(st.actions.listenerCreateQueue.match),oe.bufferTime(2e3),oe.filter((e=>e.length>0)),oe.mergeMap((e=>{const t=null==e?void 0:e.map((e=>e.payload.tag));return se.of(st.actions.listenerCreateQueueComplete({tags:t}))})))),(e=>e.pipe(oe.filter(st.actions.listenerDeleteQueue.match),oe.bufferTime(2e3),oe.filter((e=>e.length>0)),oe.mergeMap((e=>{const t=null==e?void 0:e.map((e=>e.payload.tagId));return se.of(st.actions.listenerDeleteQueueComplete({tagIds:t}))})))),(e=>e.pipe(oe.filter(st.actions.listenerUpdateQueue.match),oe.bufferTime(2e3),oe.filter((e=>e.length>0)),oe.mergeMap((e=>{const t=null==e?void 0:e.map((e=>e.payload.tag));return se.of(st.actions.listenerUpdateQueueComplete({tags:t}))})))),(e=>e.pipe(ie.ofType(st.actions.listenerCreateQueueComplete.type,st.actions.listenerUpdateQueueComplete.type),oe.bufferTime(1e3),oe.filter((e=>e.length>0)),oe.mergeMap((()=>se.of(st.actions.sort()))))),((e,t,n)=>{let{client:a}=n;return e.pipe(oe.filter(st.actions.updateRequest.match),oe.withLatestFrom(t),oe.mergeMap((e=>{let[t,n]=e;var i;const{closeDialogId:s,formData:o,tag:l}=t.payload;return se.of(t).pipe(Je(n.debug.badConnection),tt(a,null==(i=null==o?void 0:o.name)?void 0:i.current),oe.mergeMap((()=>se.from(a.patch(l._id).set({name:{_type:"slug",current:null==o?void 0:o.name.current}}).commit()))),oe.mergeMap((e=>se.of(st.actions.updateComplete({closeDialogId:s,tag:e})))),oe.catchError((e=>se.of(st.actions.updateError({error:{message:(null==e?void 0:e.message)||"Internal error",statusCode:(null==e?void 0:e.statusCode)||500},tag:l})))))})))}),((e,t,n)=>{let{client:a}=n;return e.pipe(oe.filter(Wa.uploadStart.match),oe.mergeMap((t=>{const{file:n,uploadItem:i}=t.payload;return se.merge(se.of(null).pipe(oe.mergeMap((()=>(e=>se.of(null).pipe(oe.mergeMap((()=>se.from(Pa(e))))))(n))),oe.mergeMap((e=>se.of(Wa.previewReady({blobUrl:e,hash:i.hash}))))),se.of(null).pipe(oe.mergeMap((()=>Ha(a,i.assetType,n,i.hash))),oe.takeUntil(e.pipe(oe.filter(Wa.uploadCancel.match),oe.filter((e=>e.payload.hash===i.hash)))),oe.mergeMap((e=>"complete"===(null==e?void 0:e.type)?se.of(ft.uploadComplete({asset:e.asset})):"progress"===(null==e?void 0:e.type)&&"upload"===(null==e?void 0:e.stage)?se.of(Wa.uploadProgress({event:e,uploadHash:i.hash})):se.empty())),oe.catchError((e=>se.of(Wa.uploadError({error:{message:(null==e?void 0:e.message)||"Internal error",statusCode:(null==e?void 0:e.statusCode)||500},hash:i.hash}))))))})))}),((e,t)=>e.pipe(oe.filter(Wa.uploadRequest.match),oe.withLatestFrom(t),oe.mergeMap((e=>{let[t,n]=e;const{file:a,forceAsAssetType:i}=t.payload;return se.of(t).pipe(oe.mergeMap((()=>Xa(a))),oe.filter((e=>!!!n.uploads.byIds[e])),oe.mergeMap((e=>{const t={_type:"upload",assetType:i||(a.type.indexOf("image")>=0?"image":"file"),hash:e,name:a.name,size:a.size,status:"queued"};return se.of(Wa.uploadStart({file:a,uploadItem:t}))})))})))),((e,t,n)=>{let{client:a}=n;return e.pipe(oe.filter(Wa.checkRequest.match),oe.withLatestFrom(t),oe.mergeMap((e=>{let[t,n]=e;const{assets:i}=t.payload,s=i.map((e=>e._id)),o=et({assetTypes:n.assets.assetTypes,searchFacets:n.search.facets,searchQuery:n.search.query}),l=Se.default(R||(R=Y(["\n        *["," && _id in $documentIds].sha1hash\n      "])),o);return se.of(t).pipe(oe.delay(1e3),oe.mergeMap((()=>a.observable.fetch(l,{documentIds:s}))),oe.mergeMap((e=>{const t=i.reduce(((t,n)=>(t[n.sha1hash]=e.includes(n.sha1hash)?n._id:null,t)),{});return se.of(Wa.checkComplete({results:t}),Tt.insertUploads({results:t}))})))})))}),(e=>e.pipe(oe.filter(ft.uploadComplete.match),oe.mergeMap((e=>se.of(Wa.checkRequest({assets:[e.payload.asset]}))))))),Ci=ne.combineReducers({assets:_t,debug:Cn,dialog:zt,notifications:ji,search:gt,selected:yi,tags:ct,uploads:$a}),wi=e=>null!==e&&"object"==typeof e&&!Array.isArray(e),Ti=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];var n,a;return Array.isArray(e)&&e.forEach((e=>{Ti(e,t)})),wi(e)&&("reference"===(null==(n=null==e?void 0:e.asset)?void 0:n._type)&&(null==(a=null==e?void 0:e.asset)?void 0:a._ref)&&t.push(e.asset._ref),Object.values(e).forEach((e=>{Ti(e,t)}))),t},ki=e=>{const t=Ti(e);return[...new Set(t.sort())]};class Si extends Z.Component{constructor(e){super(e);const t=ie.createEpicMiddleware({dependencies:{client:e.client}});this.store=ne.configureStore({reducer:Ci,middleware:e=>e({serializableCheck:!1,thunk:!1}).prepend(t),devTools:!0,preloadedState:{assets:X(X({},yt),{},{assetTypes:(null==e?void 0:e.assetType)?[e.assetType]:["file","image"]}),selected:{assets:e.selectedAssets||[],document:e.document,documentAssetIds:e.document?ki(e.document):[]}}}),t.run(Ii)}render(){return $.jsx(te.Provider,{store:this.store,children:this.props.children})}}const _i=()=>{var e;return Rt((e=>e.tags.panelVisible))?$.jsx(K.Box,{style:{position:"relative",width:250},children:$.jsx(K.Box,{className:"media__custom-scrollbar",style:{borderLeft:"1px solid ".concat(null==(e=le.hues.gray)?void 0:e[900].hex),height:"100%",overflowX:"hidden",overflowY:"auto",position:"absolute",right:0,top:0,width:"100%"},children:$.jsx(Sa,{})})}):null},Ei=_e.default.div(L||(L=Y(["\n  color: white;\n  height: 100%;\n  min-height: 100%;\n  right: 0;\n  top: 0;\n  width: 100%;\n\n  &:focus {\n    outline: none;\n  }\n"]))),Mi=_e.default.div(P||(P=Y(["\n  align-items: center;\n  background: rgba(0, 0, 0, 0.75);\n  display: flex;\n  height: 100%;\n  justify-content: center;\n  position: absolute;\n  right: 0;\n  top: 0;\n  width: 100%;\n  z-index: 3;\n"])));const Ri=e=>{const{children:t}=e,{onSelect:n}=We(),a=te.useDispatch(),i=Rt((e=>e.assets.assetTypes)),s=1===i.length&&"image"===i[0],{getRootProps:o,getInputProps:l,isDragActive:r,open:d}=Ce.useDropzone({accept:s?"image/*":"",getFilesFromEvent:async e=>{var t;let n;if("drop"===e.type&&"dataTransfer"in e&&(n=null==(t=null==e?void 0:e.dataTransfer)?void 0:t.files),"change"===e.type){const t=null==e?void 0:e.target;(null==t?void 0:t.files)&&(n=t.files)}if(!n)return[];const i=await async function(e){const t=Array.from(e),n=[];for(const e of t)try{await e.slice(0,1).arrayBuffer(),n.push(e)}catch(e){}return n}(n);return(null==n?void 0:n.length)!==i.length&&a(bi.add({status:"error",title:"Unable to upload some items (folders and packages aren't supported)"})),i},noClick:!0,noDrag:!!n,onDrop:async e=>{e.forEach((e=>a(Wa.uploadRequest({file:e,forceAsAssetType:1===i.length?i[0]:void 0}))))}});return $.jsx(Ra,{open:d,children:$.jsxs(Ei,X(X({},o()),{},{children:[$.jsx("input",X({},l())),r&&$.jsx(Mi,{children:$.jsx(K.Flex,{direction:"column",justify:"center",style:{color:le.white.hex},children:$.jsx(K.Text,{size:3,style:{color:"inherit"},children:"Drop files to upload"})})}),t]}))})},Bi=e=>{let{onClose:t}=e;const n=$e(),a=te.useDispatch(),i=e=>{const{documentId:t,result:n,transition:i}=e;"appear"===i&&a(Tt.listenerCreateQueue({asset:n})),"disappear"===i&&a(Tt.listenerDeleteQueue({assetId:t})),"update"===i&&a(Tt.listenerUpdateQueue({asset:n}))},s=e=>{const{documentId:t,result:n,transition:i}=e;"appear"===i&&a(dt.listenerCreateQueue({tag:n})),"disappear"===i&&a(dt.listenerDeleteQueue({tagId:t})),"update"===i&&a(dt.listenerUpdateQueue({tag:n}))};return Z.useEffect((()=>{a(Tt.loadPageIndex({pageIndex:0})),a(dt.fetchRequest());const e=n.listen(Se.default(U||(U=Y(['*[_type in ["sanity.fileAsset", "sanity.imageAsset"] && !(_id in path("drafts.**"))]'])))).subscribe(i),t=n.listen(Se.default(N||(N=Y(['*[_type == "','" && !(_id in path("drafts.**"))]'])),He)).subscribe(s);return()=>{null==e||e.unsubscribe(),null==t||t.unsubscribe()}}),[]),$.jsxs(Ri,{children:[$.jsx(Ea,{}),$.jsx(fi,{}),$.jsx(K.Card,{display:"flex",height:"fill",children:$.jsxs(K.Flex,{direction:"column",flex:1,children:[$.jsx(Ba,{onClose:t}),$.jsx(bn,{}),$.jsxs(K.Flex,{flex:1,children:[$.jsxs(K.Flex,{align:"flex-end",direction:"column",flex:1,style:{position:"relative"},children:[$.jsx(xi,{}),$.jsx(gi,{})]}),$.jsx(_i,{})]}),$.jsx(wn,{})]})})]})},Di=e=>{const t=$e();return $.jsx(Si,{assetType:null==e?void 0:e.assetType,client:t,document:null==e?void 0:e.document,selectedAssets:null==e?void 0:e.selectedAssets,children:$.jsx(K.ThemeProvider,{scheme:"dark",theme:K.studioTheme,children:$.jsx(K.ToastProvider,{children:$.jsxs(Ge,{onSelect:null==e?void 0:e.onSelect,children:[$.jsx(Mt,{}),$.jsx(Bi,{onClose:null==e?void 0:e.onClose})]})})})})},zi=()=>{const[e]=Z.useState((()=>document.createElement("div")));return Z.useEffect((()=>(e.classList.add("media-portal"),document.body.appendChild(e),()=>{document.body.removeChild(e)})),[]),e};var Fi={title:"Media Tag",icon:yn,name:He,type:"document",fields:[{title:"Name",name:"name",type:"slug"}],preview:{select:{name:"name"},prepare(e){const{name:t}=e;return{media:yn,title:null==t?void 0:t.current}}}};const Ai={icon:W.ImageIcon,name:"media",title:"Media"},qi=X(X({},Ai),{},{component:e=>{const{onClose:t}=e,n=zi(),a=G.useFormValue([]);qe("escape",t);const i=e=>{e.nativeEvent.stopImmediatePropagation(),e.stopPropagation()},{zIndex:s}=K.useLayer();return $.jsx(K.PortalProvider,{element:n,children:$.jsx(K.Portal,{children:$.jsx(K.Box,{onDragEnter:i,onDragLeave:i,onDragOver:i,onDrop:i,onMouseUp:i,style:{bottom:0,height:"auto",left:0,position:"fixed",top:0,width:"100%",zIndex:s},children:$.jsx(Di,X({document:a},e))})})})}}),Oi=X(X({},Ai),{},{component:()=>$.jsx(K.Flex,{direction:"column",height:"fill",flex:1,children:$.jsx(Di,{})})}),Li=G.definePlugin({name:"media",form:{file:{assetSources:e=>[...e,qi]},image:{assetSources:e=>[...e,qi]}},schema:{types:[Fi]},tools:e=>[...e,Oi]});exports.media=Li,exports.mediaAssetSource=qi;//# sourceMappingURL=index.js.map
